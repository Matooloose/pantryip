"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generate-basket/route";
exports.ids = ["app/api/generate-basket/route"];
exports.modules = {

/***/ "cheerio":
/*!**************************!*\
  !*** external "cheerio" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("cheerio");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-basket%2Froute&page=%2Fapi%2Fgenerate-basket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-basket%2Froute.ts&appDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-basket%2Froute&page=%2Fapi%2Fgenerate-basket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-basket%2Froute.ts&appDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_chosen333_Music_pantryip_app_api_generate_basket_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/generate-basket/route.ts */ \"(rsc)/./app/api/generate-basket/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generate-basket/route\",\n        pathname: \"/api/generate-basket\",\n        filename: \"route\",\n        bundlePath: \"app/api/generate-basket/route\"\n    },\n    resolvedPagePath: \"/home/chosen333/Music/pantryip/app/api/generate-basket/route.ts\",\n    nextConfigOutput,\n    userland: _home_chosen333_Music_pantryip_app_api_generate_basket_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generate-basket/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZS1iYXNrZXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlLWJhc2tldCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdlbmVyYXRlLWJhc2tldCUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGY2hvc2VuMzMzJTJGTXVzaWMlMkZwYW50cnlpcCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGaG9tZSUyRmNob3NlbjMzMyUyRk11c2ljJTJGcGFudHJ5aXAmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2U7QUFDNUY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYW50cnlpcS8/NWRlMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvaG9tZS9jaG9zZW4zMzMvTXVzaWMvcGFudHJ5aXAvYXBwL2FwaS9nZW5lcmF0ZS1iYXNrZXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dlbmVyYXRlLWJhc2tldC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlLWJhc2tldFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2VuZXJhdGUtYmFza2V0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvY2hvc2VuMzMzL011c2ljL3BhbnRyeWlwL2FwcC9hcGkvZ2VuZXJhdGUtYmFza2V0L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9nZW5lcmF0ZS1iYXNrZXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-basket%2Froute&page=%2Fapi%2Fgenerate-basket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-basket%2Froute.ts&appDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/generate-basket/route.ts":
/*!******************************************!*\
  !*** ./app/api/generate-basket/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _lib_scrapers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/scrapers */ \"(rsc)/./lib/scrapers/index.ts\");\n/* harmony import */ var _lib_huggingface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/huggingface */ \"(rsc)/./lib/huggingface.ts\");\n/* harmony import */ var _lib_ranker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/ranker */ \"(rsc)/./lib/ranker.ts\");\n\n\n\n\n\nconst RequestSchema = zod__WEBPACK_IMPORTED_MODULE_4__.object({\n    profile: zod__WEBPACK_IMPORTED_MODULE_4__.object({\n        meals: zod__WEBPACK_IMPORTED_MODULE_4__.array(zod__WEBPACK_IMPORTED_MODULE_4__.object({\n            name: zod__WEBPACK_IMPORTED_MODULE_4__.string(),\n            ingredients: zod__WEBPACK_IMPORTED_MODULE_4__.array(zod__WEBPACK_IMPORTED_MODULE_4__.object({\n                name: zod__WEBPACK_IMPORTED_MODULE_4__.string(),\n                quantity: zod__WEBPACK_IMPORTED_MODULE_4__.string(),\n                category: zod__WEBPACK_IMPORTED_MODULE_4__.string(),\n                essential: zod__WEBPACK_IMPORTED_MODULE_4__.boolean()\n            })),\n            frequency: zod__WEBPACK_IMPORTED_MODULE_4__[\"enum\"]([\n                \"daily\",\n                \"weekly\",\n                \"monthly\"\n            ])\n        })),\n        dietary_preferences: zod__WEBPACK_IMPORTED_MODULE_4__.array(zod__WEBPACK_IMPORTED_MODULE_4__.string()),\n        allergies: zod__WEBPACK_IMPORTED_MODULE_4__.array(zod__WEBPACK_IMPORTED_MODULE_4__.string()),\n        household_size: zod__WEBPACK_IMPORTED_MODULE_4__.number(),\n        shopping_frequency: zod__WEBPACK_IMPORTED_MODULE_4__[\"enum\"]([\n            \"weekly\",\n            \"biweekly\",\n            \"monthly\"\n        ])\n    }),\n    budget: zod__WEBPACK_IMPORTED_MODULE_4__.number().min(50).max(50000)\n});\n/**\n * Convert ML API recommendation response to PantryIQ ShoppingBasket format.\n */ function mlResultToBasket(mlResult, budget) {\n    const items = (mlResult.basket || []).map((entry)=>{\n        const product = entry.best_match;\n        if (!product) return null;\n        const storeName = product.Brand?.toLowerCase().includes(\"shoprite\") || product.Brand?.toLowerCase().includes(\"ritebrand\") ? \"shoprite\" : \"picknpay\";\n        return {\n            ingredient: entry.query,\n            recommended_product: {\n                id: product.Sku || `ml-${entry.query}`,\n                name: product.Product_Name,\n                brand: product.Brand || \"\",\n                price: product.Package_price,\n                weight: 0,\n                unit_price: product.price_per_100g,\n                store: storeName,\n                category: product.Sub_category || \"other\",\n                url: product.Product_URL || \"\",\n                in_stock: true,\n                scraped_at: new Date()\n            },\n            quantity_needed: \"1x\",\n            savings_vs_expensive: Math.max(0, (product.price_per_100g * 1.5 - product.price_per_100g) * 10),\n            alternatives: (entry.alternatives || []).map((alt)=>({\n                    id: alt.Sku || `alt-${entry.query}`,\n                    name: alt.Product_Name,\n                    brand: alt.Brand || \"\",\n                    price: alt.Package_price,\n                    weight: 0,\n                    unit_price: alt.price_per_100g,\n                    store: alt.Brand?.toLowerCase().includes(\"shoprite\") || alt.Brand?.toLowerCase().includes(\"ritebrand\") ? \"shoprite\" : \"picknpay\",\n                    category: alt.Sub_category || \"other\",\n                    url: alt.Product_URL || \"\",\n                    in_stock: true,\n                    scraped_at: new Date()\n                }))\n        };\n    }).filter(Boolean);\n    const totalCost = mlResult.estimated_total || items.reduce((sum, item)=>sum + item.recommended_product.price, 0);\n    // Build store breakdown\n    const storeBreakdown = {};\n    items.forEach((item)=>{\n        const store = item.recommended_product.store;\n        storeBreakdown[store] = (storeBreakdown[store] || 0) + item.recommended_product.price;\n    });\n    return {\n        items,\n        total_cost: totalCost,\n        budget,\n        budget_remaining: budget - totalCost,\n        savings_total: items.reduce((sum, item)=>sum + item.savings_vs_expensive, 0),\n        store_breakdown: storeBreakdown,\n        tips: [\n            \"\\uD83D\\uDCA1 ML-optimised basket ‚Äî prices ranked by value score\",\n            \"\\uD83C\\uDFF7Ô∏è Look for yellow specials tags in-store for extra savings\"\n        ],\n        optimization_method: \"ml_ranker\"\n    };\n}\nasync function POST(req) {\n    const startTime = Date.now();\n    try {\n        const body = await req.json();\n        const { profile, budget } = RequestSchema.parse(body);\n        console.log(\"\\n\\uD83D\\uDE80 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n        console.log(\"   GENERATE BASKET ‚Äî Pipeline Started\");\n        console.log(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\\n\");\n        console.log(`  üë§ Household size: ${profile.household_size}`);\n        console.log(`  üí∞ Budget: R${budget}`);\n        console.log(`  üçΩ  Meals detected: ${profile.meals.length}`);\n        profile.meals.forEach((m, i)=>{\n            console.log(`     ${i + 1}. ${m.name} (${m.frequency}) ‚Äî ${m.ingredients.length} ingredients`);\n        });\n        // Step 1: Extract search terms\n        console.log(\"\\n‚îÄ‚îÄ Step 1/3: Extracting search terms ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\");\n        const searchTerms = (0,_lib_scrapers__WEBPACK_IMPORTED_MODULE_1__.buildSearchTerms)(profile.meals);\n        console.log(`  üîç Search terms: [${searchTerms.join(\", \")}]`);\n        if (searchTerms.length === 0) {\n            console.log(\"  ‚ùå No search terms found ‚Äî aborting\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No ingredients found in profile\"\n            }, {\n                status: 400\n            });\n        }\n        // Step 2: Try ML-based ranking first (fast path)\n        console.log(\"\\n‚îÄ‚îÄ Step 2/3: Checking ML API availability ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\");\n        const mlReady = await (0,_lib_ranker__WEBPACK_IMPORTED_MODULE_3__.isMLApiReady)();\n        let basket;\n        let method;\n        if (mlReady) {\n            console.log(\"  ‚úÖ ML API is available ‚Äî using BudgetRanker\");\n            console.log(\"  ‚ö° This should take < 1 second...\");\n            const mlStart = Date.now();\n            const mlResult = await (0,_lib_ranker__WEBPACK_IMPORTED_MODULE_3__.recommendBasket)(searchTerms, budget);\n            if (mlResult && mlResult.basket && mlResult.basket.length > 0) {\n                const mlTime = ((Date.now() - mlStart) / 1000).toFixed(1);\n                console.log(`  ‚úÖ ML ranking complete in ${mlTime}s`);\n                basket = mlResultToBasket(mlResult, budget);\n                method = \"ml_ranker\";\n            } else {\n                console.log(\"  ‚ö†Ô∏è ML API returned no results ‚Äî falling back to Qwen\");\n                basket = await fallbackToQwen(searchTerms, profile, budget);\n                method = \"qwen_llm_fallback\";\n            }\n        } else {\n            console.log(\"  ‚ö†Ô∏è ML API not available ‚Äî using Qwen LLM\");\n            basket = await fallbackToQwen(searchTerms, profile, budget);\n            method = \"qwen_llm\";\n        }\n        const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);\n        console.log(\"\\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n        console.log(\"  \\uD83C\\uDF89 BASKET GENERATED SUCCESSFULLY\");\n        console.log(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n        console.log(`  üõí Items in basket: ${basket.items.length}`);\n        console.log(`  üí∞ Total cost: R${basket.total_cost.toFixed(2)}`);\n        console.log(`  üíö Savings: R${basket.savings_total.toFixed(2)}`);\n        console.log(`  üìâ Budget remaining: R${basket.budget_remaining.toFixed(2)}`);\n        console.log(`  üè™ Stores: ${Object.keys(basket.store_breakdown).join(\", \")}`);\n        console.log(`  ü§ñ Method: ${method}`);\n        console.log(`  ‚è±  Total pipeline time: ${totalTime}s`);\n        console.log(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\\n\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            basket,\n            products_analyzed: basket.items.length,\n            search_terms: searchTerms,\n            optimization_method: method\n        });\n    } catch (error) {\n        const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);\n        console.error(\"\\n‚ùå ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n        console.error(`   PIPELINE FAILED after ${totalTime}s`);\n        console.error(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n        console.error(\"  Error:\", error instanceof Error ? error.message : error);\n        console.error(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\\n\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Basket generation failed\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Fallback: Scrape retailers + use Qwen LLM for optimization (original behavior).\n */ async function fallbackToQwen(searchTerms, profile, budget) {\n    console.log(\"\\n‚îÄ‚îÄ Fallback: Scraping retailer prices ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\");\n    const scrapeStart = Date.now();\n    const products = await (0,_lib_scrapers__WEBPACK_IMPORTED_MODULE_1__.scrapeAllRetailers)(searchTerms);\n    const scrapeTime = ((Date.now() - scrapeStart) / 1000).toFixed(1);\n    console.log(`  ‚è±  Scraping completed in ${scrapeTime}s`);\n    console.log(`  üì¶ ${products.length} unique products available for optimization`);\n    if (products.length === 0) {\n        throw new Error(\"No products found from retailers\");\n    }\n    console.log(\"\\n‚îÄ‚îÄ Fallback: AI basket optimization (Hugging Face) ‚îÄ‚îÄ‚îÄ‚îÄ\");\n    console.log(\"  \\uD83E\\uDD16 Sending to Qwen2.5-72B-Instruct...\");\n    console.log(`  üìä Optimizing ${products.length} products against ${searchTerms.length} ingredients`);\n    console.log(\"  ‚è≥ This may take 10-30 seconds...\");\n    const aiStart = Date.now();\n    const basket = await (0,_lib_huggingface__WEBPACK_IMPORTED_MODULE_2__.optimizeShoppingBasket)(profile, products, budget);\n    const aiTime = ((Date.now() - aiStart) / 1000).toFixed(1);\n    console.log(`  ‚úÖ AI optimization complete in ${aiTime}s`);\n    return basket;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ekIsUUFBUUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFdUIsU0FBU3RCLE1BQU0sQ0FBQywyQ0FBMkMsQ0FBQztJQUVoRixJQUFJc0IsU0FBU3RCLE1BQU0sS0FBSyxHQUFHO1FBQ3pCLE1BQU0sSUFBSW1CLE1BQU07SUFDbEI7SUFFQXJCLFFBQVFDLEdBQUcsQ0FBQztJQUNaRCxRQUFRQyxHQUFHLENBQUM7SUFDWkQsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0JBQWdCLEVBQUV1QixTQUFTdEIsTUFBTSxDQUFDLGtCQUFrQixFQUFFRyxZQUFZSCxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQ25HRixRQUFRQyxHQUFHLENBQUM7SUFDWixNQUFNeUIsVUFBVXRELEtBQUt3QixHQUFHO0lBQ3hCLE1BQU1uRCxTQUFTLE1BQU01Qix3RUFBc0JBLENBQUNLLFNBQVNzRyxVQUFVckY7SUFDL0QsTUFBTXdGLFNBQVMsQ0FBQyxDQUFDdkQsS0FBS3dCLEdBQUcsS0FBSzhCLE9BQU0sSUFBSyxJQUFHLEVBQUdiLE9BQU8sQ0FBQztJQUN2RGIsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0NBQWdDLEVBQUUwQixPQUFPLENBQUMsQ0FBQztJQUV4RCxPQUFPbEY7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3BhbnRyeWlxLy4vYXBwL2FwaS9nZW5lcmF0ZS1iYXNrZXQvcm91dGUudHM/MjQzNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBzY3JhcGVBbGxSZXRhaWxlcnMsIGJ1aWxkU2VhcmNoVGVybXMgfSBmcm9tICdAL2xpYi9zY3JhcGVycyc7XG5pbXBvcnQgeyBvcHRpbWl6ZVNob3BwaW5nQmFza2V0IH0gZnJvbSAnQC9saWIvaHVnZ2luZ2ZhY2UnO1xuaW1wb3J0IHsgcmVjb21tZW5kQmFza2V0LCBpc01MQXBpUmVhZHkgfSBmcm9tICdAL2xpYi9yYW5rZXInO1xuaW1wb3J0IHsgVXNlclByb2ZpbGUsIFNob3BwaW5nQmFza2V0LCBCYXNrZXRJdGVtLCBQcm9kdWN0IH0gZnJvbSAnQC90eXBlcyc7XG5cbmNvbnN0IFJlcXVlc3RTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHByb2ZpbGU6IHoub2JqZWN0KHtcbiAgICBtZWFsczogei5hcnJheSh6Lm9iamVjdCh7XG4gICAgICBuYW1lOiB6LnN0cmluZygpLFxuICAgICAgaW5ncmVkaWVudHM6IHouYXJyYXkoei5vYmplY3Qoe1xuICAgICAgICBuYW1lOiB6LnN0cmluZygpLFxuICAgICAgICBxdWFudGl0eTogei5zdHJpbmcoKSxcbiAgICAgICAgY2F0ZWdvcnk6IHouc3RyaW5nKCksXG4gICAgICAgIGVzc2VudGlhbDogei5ib29sZWFuKCksXG4gICAgICB9KSksXG4gICAgICBmcmVxdWVuY3k6IHouZW51bShbJ2RhaWx5JywgJ3dlZWtseScsICdtb250aGx5J10pLFxuICAgIH0pKSxcbiAgICBkaWV0YXJ5X3ByZWZlcmVuY2VzOiB6LmFycmF5KHouc3RyaW5nKCkpLFxuICAgIGFsbGVyZ2llczogei5hcnJheSh6LnN0cmluZygpKSxcbiAgICBob3VzZWhvbGRfc2l6ZTogei5udW1iZXIoKSxcbiAgICBzaG9wcGluZ19mcmVxdWVuY3k6IHouZW51bShbJ3dlZWtseScsICdiaXdlZWtseScsICdtb250aGx5J10pLFxuICB9KSxcbiAgYnVkZ2V0OiB6Lm51bWJlcigpLm1pbig1MCkubWF4KDUwMDAwKSxcbn0pO1xuXG4vKipcbiAqIENvbnZlcnQgTUwgQVBJIHJlY29tbWVuZGF0aW9uIHJlc3BvbnNlIHRvIFBhbnRyeUlRIFNob3BwaW5nQmFza2V0IGZvcm1hdC5cbiAqL1xuZnVuY3Rpb24gbWxSZXN1bHRUb0Jhc2tldChtbFJlc3VsdDogYW55LCBidWRnZXQ6IG51bWJlcik6IFNob3BwaW5nQmFza2V0IHtcbiAgY29uc3QgaXRlbXM6IEJhc2tldEl0ZW1bXSA9IChtbFJlc3VsdC5iYXNrZXQgfHwgW10pLm1hcCgoZW50cnk6IGFueSkgPT4ge1xuICAgIGNvbnN0IHByb2R1Y3QgPSBlbnRyeS5iZXN0X21hdGNoO1xuICAgIGlmICghcHJvZHVjdCkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBzdG9yZU5hbWUgPSBwcm9kdWN0LkJyYW5kPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzaG9wcml0ZScpIHx8IHByb2R1Y3QuQnJhbmQ/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3JpdGVicmFuZCcpXG4gICAgICA/ICdzaG9wcml0ZScgOiAncGlja25wYXknO1xuICAgIHJldHVybiB7XG4gICAgICBpbmdyZWRpZW50OiBlbnRyeS5xdWVyeSxcbiAgICAgIHJlY29tbWVuZGVkX3Byb2R1Y3Q6IHtcbiAgICAgICAgaWQ6IHByb2R1Y3QuU2t1IHx8IGBtbC0ke2VudHJ5LnF1ZXJ5fWAsXG4gICAgICAgIG5hbWU6IHByb2R1Y3QuUHJvZHVjdF9OYW1lLFxuICAgICAgICBicmFuZDogcHJvZHVjdC5CcmFuZCB8fCAnJyxcbiAgICAgICAgcHJpY2U6IHByb2R1Y3QuUGFja2FnZV9wcmljZSxcbiAgICAgICAgd2VpZ2h0OiAwLFxuICAgICAgICB1bml0X3ByaWNlOiBwcm9kdWN0LnByaWNlX3Blcl8xMDBnLFxuICAgICAgICBzdG9yZTogc3RvcmVOYW1lIGFzIFByb2R1Y3RbJ3N0b3JlJ10sXG4gICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LlN1Yl9jYXRlZ29yeSB8fCAnb3RoZXInLFxuICAgICAgICB1cmw6IHByb2R1Y3QuUHJvZHVjdF9VUkwgfHwgJycsXG4gICAgICAgIGluX3N0b2NrOiB0cnVlLFxuICAgICAgICBzY3JhcGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgICAgfSxcbiAgICAgIHF1YW50aXR5X25lZWRlZDogJzF4JyxcbiAgICAgIHNhdmluZ3NfdnNfZXhwZW5zaXZlOiBNYXRoLm1heCgwLCAocHJvZHVjdC5wcmljZV9wZXJfMTAwZyAqIDEuNSAtIHByb2R1Y3QucHJpY2VfcGVyXzEwMGcpICogMTApLFxuICAgICAgYWx0ZXJuYXRpdmVzOiAoZW50cnkuYWx0ZXJuYXRpdmVzIHx8IFtdKS5tYXAoKGFsdDogYW55KSA9PiAoe1xuICAgICAgICBpZDogYWx0LlNrdSB8fCBgYWx0LSR7ZW50cnkucXVlcnl9YCxcbiAgICAgICAgbmFtZTogYWx0LlByb2R1Y3RfTmFtZSxcbiAgICAgICAgYnJhbmQ6IGFsdC5CcmFuZCB8fCAnJyxcbiAgICAgICAgcHJpY2U6IGFsdC5QYWNrYWdlX3ByaWNlLFxuICAgICAgICB3ZWlnaHQ6IDAsXG4gICAgICAgIHVuaXRfcHJpY2U6IGFsdC5wcmljZV9wZXJfMTAwZyxcbiAgICAgICAgc3RvcmU6IChhbHQuQnJhbmQ/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Nob3ByaXRlJykgfHwgYWx0LkJyYW5kPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdyaXRlYnJhbmQnKVxuICAgICAgICAgID8gJ3Nob3ByaXRlJyA6ICdwaWNrbnBheScpIGFzIFByb2R1Y3RbJ3N0b3JlJ10sXG4gICAgICAgIGNhdGVnb3J5OiBhbHQuU3ViX2NhdGVnb3J5IHx8ICdvdGhlcicsXG4gICAgICAgIHVybDogYWx0LlByb2R1Y3RfVVJMIHx8ICcnLFxuICAgICAgICBpbl9zdG9jazogdHJ1ZSxcbiAgICAgICAgc2NyYXBlZF9hdDogbmV3IERhdGUoKSxcbiAgICAgIH0pKSxcbiAgICB9O1xuICB9KS5maWx0ZXIoQm9vbGVhbikgYXMgQmFza2V0SXRlbVtdO1xuXG4gIGNvbnN0IHRvdGFsQ29zdCA9IG1sUmVzdWx0LmVzdGltYXRlZF90b3RhbCB8fCBpdGVtcy5yZWR1Y2UoKHN1bTogbnVtYmVyLCBpdGVtOiBCYXNrZXRJdGVtKSA9PiBzdW0gKyBpdGVtLnJlY29tbWVuZGVkX3Byb2R1Y3QucHJpY2UsIDApO1xuXG4gIC8vIEJ1aWxkIHN0b3JlIGJyZWFrZG93blxuICBjb25zdCBzdG9yZUJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICBpdGVtcy5mb3JFYWNoKChpdGVtOiBCYXNrZXRJdGVtKSA9PiB7XG4gICAgY29uc3Qgc3RvcmUgPSBpdGVtLnJlY29tbWVuZGVkX3Byb2R1Y3Quc3RvcmU7XG4gICAgc3RvcmVCcmVha2Rvd25bc3RvcmVdID0gKHN0b3JlQnJlYWtkb3duW3N0b3JlXSB8fCAwKSArIGl0ZW0ucmVjb21tZW5kZWRfcHJvZHVjdC5wcmljZTtcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBpdGVtcyxcbiAgICB0b3RhbF9jb3N0OiB0b3RhbENvc3QsXG4gICAgYnVkZ2V0LFxuICAgIGJ1ZGdldF9yZW1haW5pbmc6IGJ1ZGdldCAtIHRvdGFsQ29zdCxcbiAgICBzYXZpbmdzX3RvdGFsOiBpdGVtcy5yZWR1Y2UoKHN1bTogbnVtYmVyLCBpdGVtOiBCYXNrZXRJdGVtKSA9PiBzdW0gKyBpdGVtLnNhdmluZ3NfdnNfZXhwZW5zaXZlLCAwKSxcbiAgICBzdG9yZV9icmVha2Rvd246IHN0b3JlQnJlYWtkb3duLFxuICAgIHRpcHM6IFtcbiAgICAgICfwn5KhIE1MLW9wdGltaXNlZCBiYXNrZXQg4oCUIHByaWNlcyByYW5rZWQgYnkgdmFsdWUgc2NvcmUnLFxuICAgICAgJ/Cfj7fvuI8gTG9vayBmb3IgeWVsbG93IHNwZWNpYWxzIHRhZ3MgaW4tc3RvcmUgZm9yIGV4dHJhIHNhdmluZ3MnLFxuICAgIF0sXG4gICAgb3B0aW1pemF0aW9uX21ldGhvZDogJ21sX3JhbmtlcicsXG4gIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgICBjb25zdCB7IHByb2ZpbGUsIGJ1ZGdldCB9ID0gUmVxdWVzdFNjaGVtYS5wYXJzZShib2R5KTtcblxuICAgIGNvbnNvbGUubG9nKCdcXG7wn5qAIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkCcpO1xuICAgIGNvbnNvbGUubG9nKCcgICBHRU5FUkFURSBCQVNLRVQg4oCUIFBpcGVsaW5lIFN0YXJ0ZWQnKTtcbiAgICBjb25zb2xlLmxvZygn4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXFxuJyk7XG4gICAgY29uc29sZS5sb2coYCAg8J+RpCBIb3VzZWhvbGQgc2l6ZTogJHtwcm9maWxlLmhvdXNlaG9sZF9zaXplfWApO1xuICAgIGNvbnNvbGUubG9nKGAgIPCfkrAgQnVkZ2V0OiBSJHtidWRnZXR9YCk7XG4gICAgY29uc29sZS5sb2coYCAg8J+NvSAgTWVhbHMgZGV0ZWN0ZWQ6ICR7cHJvZmlsZS5tZWFscy5sZW5ndGh9YCk7XG4gICAgcHJvZmlsZS5tZWFscy5mb3JFYWNoKChtLCBpKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgICAgICAke2kgKyAxfS4gJHttLm5hbWV9ICgke20uZnJlcXVlbmN5fSkg4oCUICR7bS5pbmdyZWRpZW50cy5sZW5ndGh9IGluZ3JlZGllbnRzYCk7XG4gICAgfSk7XG5cbiAgICAvLyBTdGVwIDE6IEV4dHJhY3Qgc2VhcmNoIHRlcm1zXG4gICAgY29uc29sZS5sb2coJ1xcbuKUgOKUgCBTdGVwIDEvMzogRXh0cmFjdGluZyBzZWFyY2ggdGVybXMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJyk7XG4gICAgY29uc3Qgc2VhcmNoVGVybXMgPSBidWlsZFNlYXJjaFRlcm1zKHByb2ZpbGUubWVhbHMpO1xuICAgIGNvbnNvbGUubG9nKGAgIPCflI0gU2VhcmNoIHRlcm1zOiBbJHtzZWFyY2hUZXJtcy5qb2luKCcsICcpfV1gKTtcblxuICAgIGlmIChzZWFyY2hUZXJtcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCcgIOKdjCBObyBzZWFyY2ggdGVybXMgZm91bmQg4oCUIGFib3J0aW5nJyk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdObyBpbmdyZWRpZW50cyBmb3VuZCBpbiBwcm9maWxlJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gU3RlcCAyOiBUcnkgTUwtYmFzZWQgcmFua2luZyBmaXJzdCAoZmFzdCBwYXRoKVxuICAgIGNvbnNvbGUubG9nKCdcXG7ilIDilIAgU3RlcCAyLzM6IENoZWNraW5nIE1MIEFQSSBhdmFpbGFiaWxpdHkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJyk7XG4gICAgY29uc3QgbWxSZWFkeSA9IGF3YWl0IGlzTUxBcGlSZWFkeSgpO1xuXG4gICAgbGV0IGJhc2tldDogU2hvcHBpbmdCYXNrZXQ7XG4gICAgbGV0IG1ldGhvZDogc3RyaW5nO1xuXG4gICAgaWYgKG1sUmVhZHkpIHtcbiAgICAgIGNvbnNvbGUubG9nKCcgIOKchSBNTCBBUEkgaXMgYXZhaWxhYmxlIOKAlCB1c2luZyBCdWRnZXRSYW5rZXInKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgIOKaoSBUaGlzIHNob3VsZCB0YWtlIDwgMSBzZWNvbmQuLi4nKTtcbiAgICAgIGNvbnN0IG1sU3RhcnQgPSBEYXRlLm5vdygpO1xuXG4gICAgICBjb25zdCBtbFJlc3VsdCA9IGF3YWl0IHJlY29tbWVuZEJhc2tldChzZWFyY2hUZXJtcywgYnVkZ2V0KTtcblxuICAgICAgaWYgKG1sUmVzdWx0ICYmIG1sUmVzdWx0LmJhc2tldCAmJiBtbFJlc3VsdC5iYXNrZXQubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBtbFRpbWUgPSAoKERhdGUubm93KCkgLSBtbFN0YXJ0KSAvIDEwMDApLnRvRml4ZWQoMSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgIOKchSBNTCByYW5raW5nIGNvbXBsZXRlIGluICR7bWxUaW1lfXNgKTtcblxuICAgICAgICBiYXNrZXQgPSBtbFJlc3VsdFRvQmFza2V0KG1sUmVzdWx0LCBidWRnZXQpO1xuICAgICAgICBtZXRob2QgPSAnbWxfcmFua2VyJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCcgIOKaoO+4jyBNTCBBUEkgcmV0dXJuZWQgbm8gcmVzdWx0cyDigJQgZmFsbGluZyBiYWNrIHRvIFF3ZW4nKTtcbiAgICAgICAgYmFza2V0ID0gYXdhaXQgZmFsbGJhY2tUb1F3ZW4oc2VhcmNoVGVybXMsIHByb2ZpbGUgYXMgVXNlclByb2ZpbGUsIGJ1ZGdldCk7XG4gICAgICAgIG1ldGhvZCA9ICdxd2VuX2xsbV9mYWxsYmFjayc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCcgIOKaoO+4jyBNTCBBUEkgbm90IGF2YWlsYWJsZSDigJQgdXNpbmcgUXdlbiBMTE0nKTtcbiAgICAgIGJhc2tldCA9IGF3YWl0IGZhbGxiYWNrVG9Rd2VuKHNlYXJjaFRlcm1zLCBwcm9maWxlIGFzIFVzZXJQcm9maWxlLCBidWRnZXQpO1xuICAgICAgbWV0aG9kID0gJ3F3ZW5fbGxtJztcbiAgICB9XG5cbiAgICBjb25zdCB0b3RhbFRpbWUgPSAoKERhdGUubm93KCkgLSBzdGFydFRpbWUpIC8gMTAwMCkudG9GaXhlZCgxKTtcblxuICAgIGNvbnNvbGUubG9nKCdcXG7ilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAnKTtcbiAgICBjb25zb2xlLmxvZygnICDwn46JIEJBU0tFVCBHRU5FUkFURUQgU1VDQ0VTU0ZVTExZJyk7XG4gICAgY29uc29sZS5sb2coJ+KVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkCcpO1xuICAgIGNvbnNvbGUubG9nKGAgIPCfm5IgSXRlbXMgaW4gYmFza2V0OiAke2Jhc2tldC5pdGVtcy5sZW5ndGh9YCk7XG4gICAgY29uc29sZS5sb2coYCAg8J+SsCBUb3RhbCBjb3N0OiBSJHtiYXNrZXQudG90YWxfY29zdC50b0ZpeGVkKDIpfWApO1xuICAgIGNvbnNvbGUubG9nKGAgIPCfkpogU2F2aW5nczogUiR7YmFza2V0LnNhdmluZ3NfdG90YWwudG9GaXhlZCgyKX1gKTtcbiAgICBjb25zb2xlLmxvZyhgICDwn5OJIEJ1ZGdldCByZW1haW5pbmc6IFIke2Jhc2tldC5idWRnZXRfcmVtYWluaW5nLnRvRml4ZWQoMil9YCk7XG4gICAgY29uc29sZS5sb2coYCAg8J+PqiBTdG9yZXM6ICR7T2JqZWN0LmtleXMoYmFza2V0LnN0b3JlX2JyZWFrZG93bikuam9pbignLCAnKX1gKTtcbiAgICBjb25zb2xlLmxvZyhgICDwn6SWIE1ldGhvZDogJHttZXRob2R9YCk7XG4gICAgY29uc29sZS5sb2coYCAg4o+xICBUb3RhbCBwaXBlbGluZSB0aW1lOiAke3RvdGFsVGltZX1zYCk7XG4gICAgY29uc29sZS5sb2coJ+KVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkFxcbicpO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBiYXNrZXQsXG4gICAgICBwcm9kdWN0c19hbmFseXplZDogYmFza2V0Lml0ZW1zLmxlbmd0aCxcbiAgICAgIHNlYXJjaF90ZXJtczogc2VhcmNoVGVybXMsXG4gICAgICBvcHRpbWl6YXRpb25fbWV0aG9kOiBtZXRob2QsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgdG90YWxUaW1lID0gKChEYXRlLm5vdygpIC0gc3RhcnRUaW1lKSAvIDEwMDApLnRvRml4ZWQoMSk7XG4gICAgY29uc29sZS5lcnJvcignXFxu4p2MIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkCcpO1xuICAgIGNvbnNvbGUuZXJyb3IoYCAgIFBJUEVMSU5FIEZBSUxFRCBhZnRlciAke3RvdGFsVGltZX1zYCk7XG4gICAgY29uc29sZS5lcnJvcign4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQJyk7XG4gICAgY29uc29sZS5lcnJvcignICBFcnJvcjonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IGVycm9yKTtcbiAgICBjb25zb2xlLmVycm9yKCfilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZBcXG4nKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdCYXNrZXQgZ2VuZXJhdGlvbiBmYWlsZWQnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8qKlxuICogRmFsbGJhY2s6IFNjcmFwZSByZXRhaWxlcnMgKyB1c2UgUXdlbiBMTE0gZm9yIG9wdGltaXphdGlvbiAob3JpZ2luYWwgYmVoYXZpb3IpLlxuICovXG5hc3luYyBmdW5jdGlvbiBmYWxsYmFja1RvUXdlbihzZWFyY2hUZXJtczogc3RyaW5nW10sIHByb2ZpbGU6IFVzZXJQcm9maWxlLCBidWRnZXQ6IG51bWJlcik6IFByb21pc2U8U2hvcHBpbmdCYXNrZXQ+IHtcbiAgY29uc29sZS5sb2coJ1xcbuKUgOKUgCBGYWxsYmFjazogU2NyYXBpbmcgcmV0YWlsZXIgcHJpY2VzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpO1xuICBjb25zdCBzY3JhcGVTdGFydCA9IERhdGUubm93KCk7XG4gIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgc2NyYXBlQWxsUmV0YWlsZXJzKHNlYXJjaFRlcm1zKTtcbiAgY29uc3Qgc2NyYXBlVGltZSA9ICgoRGF0ZS5ub3coKSAtIHNjcmFwZVN0YXJ0KSAvIDEwMDApLnRvRml4ZWQoMSk7XG4gIGNvbnNvbGUubG9nKGAgIOKPsSAgU2NyYXBpbmcgY29tcGxldGVkIGluICR7c2NyYXBlVGltZX1zYCk7XG4gIGNvbnNvbGUubG9nKGAgIPCfk6YgJHtwcm9kdWN0cy5sZW5ndGh9IHVuaXF1ZSBwcm9kdWN0cyBhdmFpbGFibGUgZm9yIG9wdGltaXphdGlvbmApO1xuXG4gIGlmIChwcm9kdWN0cy5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHByb2R1Y3RzIGZvdW5kIGZyb20gcmV0YWlsZXJzJyk7XG4gIH1cblxuICBjb25zb2xlLmxvZygnXFxu4pSA4pSAIEZhbGxiYWNrOiBBSSBiYXNrZXQgb3B0aW1pemF0aW9uIChIdWdnaW5nIEZhY2UpIOKUgOKUgOKUgOKUgCcpO1xuICBjb25zb2xlLmxvZygnICDwn6SWIFNlbmRpbmcgdG8gUXdlbjIuNS03MkItSW5zdHJ1Y3QuLi4nKTtcbiAgY29uc29sZS5sb2coYCAg8J+TiiBPcHRpbWl6aW5nICR7cHJvZHVjdHMubGVuZ3RofSBwcm9kdWN0cyBhZ2FpbnN0ICR7c2VhcmNoVGVybXMubGVuZ3RofSBpbmdyZWRpZW50c2ApO1xuICBjb25zb2xlLmxvZygnICDij7MgVGhpcyBtYXkgdGFrZSAxMC0zMCBzZWNvbmRzLi4uJyk7XG4gIGNvbnN0IGFpU3RhcnQgPSBEYXRlLm5vdygpO1xuICBjb25zdCBiYXNrZXQgPSBhd2FpdCBvcHRpbWl6ZVNob3BwaW5nQmFza2V0KHByb2ZpbGUsIHByb2R1Y3RzLCBidWRnZXQpO1xuICBjb25zdCBhaVRpbWUgPSAoKERhdGUubm93KCkgLSBhaVN0YXJ0KSAvIDEwMDApLnRvRml4ZWQoMSk7XG4gIGNvbnNvbGUubG9nKGAgIOKchSBBSSBvcHRpbWl6YXRpb24gY29tcGxldGUgaW4gJHthaVRpbWV9c2ApO1xuXG4gIHJldHVybiBiYXNrZXQ7XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwieiIsInNjcmFwZUFsbFJldGFpbGVycyIsImJ1aWxkU2VhcmNoVGVybXMiLCJvcHRpbWl6ZVNob3BwaW5nQmFza2V0IiwicmVjb21tZW5kQmFza2V0IiwiaXNNTEFwaVJlYWR5IiwiUmVxdWVzdFNjaGVtYSIsIm9iamVjdCIsInByb2ZpbGUiLCJtZWFscyIsImFycmF5IiwibmFtZSIsInN0cmluZyIsImluZ3JlZGllbnRzIiwicXVhbnRpdHkiLCJjYXRlZ29yeSIsImVzc2VudGlhbCIsImJvb2xlYW4iLCJmcmVxdWVuY3kiLCJlbnVtIiwiZGlldGFyeV9wcmVmZXJlbmNlcyIsImFsbGVyZ2llcyIsImhvdXNlaG9sZF9zaXplIiwibnVtYmVyIiwic2hvcHBpbmdfZnJlcXVlbmN5IiwiYnVkZ2V0IiwibWluIiwibWF4IiwibWxSZXN1bHRUb0Jhc2tldCIsIm1sUmVzdWx0IiwiaXRlbXMiLCJiYXNrZXQiLCJtYXAiLCJlbnRyeSIsInByb2R1Y3QiLCJiZXN0X21hdGNoIiwic3RvcmVOYW1lIiwiQnJhbmQiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiaW5ncmVkaWVudCIsInF1ZXJ5IiwicmVjb21tZW5kZWRfcHJvZHVjdCIsImlkIiwiU2t1IiwiUHJvZHVjdF9OYW1lIiwiYnJhbmQiLCJwcmljZSIsIlBhY2thZ2VfcHJpY2UiLCJ3ZWlnaHQiLCJ1bml0X3ByaWNlIiwicHJpY2VfcGVyXzEwMGciLCJzdG9yZSIsIlN1Yl9jYXRlZ29yeSIsInVybCIsIlByb2R1Y3RfVVJMIiwiaW5fc3RvY2siLCJzY3JhcGVkX2F0IiwiRGF0ZSIsInF1YW50aXR5X25lZWRlZCIsInNhdmluZ3NfdnNfZXhwZW5zaXZlIiwiTWF0aCIsImFsdGVybmF0aXZlcyIsImFsdCIsImZpbHRlciIsIkJvb2xlYW4iLCJ0b3RhbENvc3QiLCJlc3RpbWF0ZWRfdG90YWwiLCJyZWR1Y2UiLCJzdW0iLCJpdGVtIiwic3RvcmVCcmVha2Rvd24iLCJmb3JFYWNoIiwidG90YWxfY29zdCIsImJ1ZGdldF9yZW1haW5pbmciLCJzYXZpbmdzX3RvdGFsIiwic3RvcmVfYnJlYWtkb3duIiwidGlwcyIsIm9wdGltaXphdGlvbl9tZXRob2QiLCJQT1NUIiwicmVxIiwic3RhcnRUaW1lIiwibm93IiwiYm9keSIsImpzb24iLCJwYXJzZSIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJtIiwiaSIsInNlYXJjaFRlcm1zIiwiam9pbiIsImVycm9yIiwic3RhdHVzIiwibWxSZWFkeSIsIm1ldGhvZCIsIm1sU3RhcnQiLCJtbFRpbWUiLCJ0b0ZpeGVkIiwiZmFsbGJhY2tUb1F3ZW4iLCJ0b3RhbFRpbWUiLCJPYmplY3QiLCJrZXlzIiwic3VjY2VzcyIsInByb2R1Y3RzX2FuYWx5emVkIiwic2VhcmNoX3Rlcm1zIiwiRXJyb3IiLCJtZXNzYWdlIiwic2NyYXBlU3RhcnQiLCJwcm9kdWN0cyIsInNjcmFwZVRpbWUiLCJhaVN0YXJ0IiwiYWlUaW1lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/generate-basket/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/huggingface.ts":
/*!****************************!*\
  !*** ./lib/huggingface.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractProfileFromTranscript: () => (/* binding */ extractProfileFromTranscript),\n/* harmony export */   optimizeShoppingBasket: () => (/* binding */ optimizeShoppingBasket)\n/* harmony export */ });\nconst HF_TOKEN = process.env.HF_TOKEN;\nconst API_URL = \"https://router.huggingface.co/v1/chat/completions\";\nconst MODEL = \"Qwen/Qwen2.5-72B-Instruct\";\n/**\n * Calls Hugging Face Inference API directly via fetch.\n * Includes 60s timeout and 1 retry on failure.\n */ async function chatCompletion(systemPrompt, userMessage, maxTokens = 2048) {\n    const MAX_RETRIES = 2;\n    const TIMEOUT_MS = 60000; // 60 seconds\n    const requestBody = JSON.stringify({\n        model: MODEL,\n        messages: [\n            {\n                role: \"system\",\n                content: systemPrompt\n            },\n            {\n                role: \"user\",\n                content: userMessage\n            }\n        ],\n        max_tokens: maxTokens,\n        temperature: 0.3\n    });\n    console.log(`  [HF] Request size: ${(requestBody.length / 1024).toFixed(1)}KB, max_tokens: ${maxTokens}`);\n    for(let attempt = 1; attempt <= MAX_RETRIES; attempt++){\n        const controller = new AbortController();\n        const timeoutId = setTimeout(()=>controller.abort(), TIMEOUT_MS);\n        try {\n            console.log(`  [HF] Attempt ${attempt}/${MAX_RETRIES} ‚Äî calling ${MODEL}...`);\n            const startTime = Date.now();\n            const response = await fetch(API_URL, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${HF_TOKEN}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: requestBody,\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);\n            if (!response.ok) {\n                const errorBody = await response.text();\n                console.error(`  [HF] ‚ùå API error (${response.status}) after ${elapsed}s: ${errorBody.substring(0, 200)}`);\n                if (attempt < MAX_RETRIES) {\n                    console.log(`  [HF] Retrying in 2s...`);\n                    await new Promise((r)=>setTimeout(r, 2000));\n                    continue;\n                }\n                throw new Error(`Hugging Face API error (${response.status}): ${errorBody}`);\n            }\n            const data = await response.json();\n            const text = data.choices?.[0]?.message?.content ?? \"\";\n            console.log(`  [HF] ‚úÖ Response received in ${elapsed}s (${text.length} chars)`);\n            return text;\n        } catch (err) {\n            clearTimeout(timeoutId);\n            if (err.name === \"AbortError\") {\n                console.error(`  [HF] ‚è∞ Request timed out after ${TIMEOUT_MS / 1000}s`);\n            } else {\n                console.error(`  [HF] ‚ùå Fetch error: ${err.message}`);\n            }\n            if (attempt < MAX_RETRIES) {\n                console.log(`  [HF] Retrying in 2s...`);\n                await new Promise((r)=>setTimeout(r, 2000));\n                continue;\n            }\n            throw err;\n        }\n    }\n    throw new Error(\"All retry attempts exhausted\");\n}\n/**\n * Extracts structured meal and ingredient data from a voice transcript.\n * Returns a fully typed UserProfile with meals, ingredients, and preferences.\n */ async function extractProfileFromTranscript(transcript, household_size = 1) {\n    const systemPrompt = `You are a dietary analysis expert. Extract structured meal and ingredient data from a user's spoken description of their cooking habits. \n    \n    Return ONLY valid JSON with this exact structure:\n    {\n      \"meals\": [\n        {\n          \"name\": \"meal name\",\n          \"ingredients\": [\n            { \"name\": \"ingredient\", \"quantity\": \"500g\", \"category\": \"protein|vegetable|grain|dairy|condiment|other\", \"essential\": true }\n          ],\n          \"frequency\": \"daily|weekly|monthly\"\n        }\n      ],\n      \"dietary_preferences\": [\"string\"],\n      \"allergies\": [\"string\"],\n      \"household_size\": number,\n      \"shopping_frequency\": \"weekly|biweekly|monthly\"\n    }\n    \n    Be practical and thorough. Infer South African context (pap, braai, etc.). If quantity not specified, infer reasonable amounts for the household size.`;\n    const userMessage = `Household size: ${household_size} people.\\n\\nTranscript: \"${transcript}\"\\n\\nExtract the meal profile as JSON.`;\n    const text = await chatCompletion(systemPrompt, userMessage);\n    try {\n        const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n        if (!jsonMatch) throw new Error(\"No JSON found in response\");\n        const profile = JSON.parse(jsonMatch[0]);\n        profile.household_size = household_size;\n        return profile;\n    } catch  {\n        throw new Error(`Failed to parse model response: ${text}`);\n    }\n}\n/**\n * Takes scraped products and a user profile, returns an optimized shopping basket\n * that stays within budget and matches user preferences.\n */ async function optimizeShoppingBasket(profile, products, budget) {\n    const productCatalog = products.map((p)=>({\n            id: p.id,\n            name: p.name,\n            brand: p.brand,\n            price: p.price,\n            weight: p.weight,\n            unit_price: p.unit_price,\n            store: p.store,\n            category: p.category\n        }));\n    const allIngredients = profile.meals.flatMap((m)=>m.ingredients);\n    const uniqueIngredients = Array.from(new Map(allIngredients.map((i)=>[\n            i.name.toLowerCase(),\n            i\n        ])).values());\n    const systemPrompt = `You are a smart shopping optimization engine for South African consumers. \n    \n    Given a list of needed ingredients and available products from Pick n Pay, Shoprite, and Checkers, build the most cost-effective shopping basket.\n    \n    Rules:\n    1. Prioritize best value (lowest unit price) while respecting brand preferences\n    2. Do NOT exceed the budget\n    3. For each ingredient, pick 1 recommended product and 1-2 alternatives\n    4. Calculate exact savings vs choosing the most expensive option\n    5. Generate practical shopping tips for the user\n    \n    Return ONLY valid JSON:\n    {\n      \"items\": [\n        {\n          \"ingredient\": \"string\",\n          \"recommended_product_id\": \"string\",\n          \"alternative_product_ids\": [\"string\"],\n          \"quantity_needed\": \"string\",\n          \"savings_vs_expensive\": number\n        }\n      ],\n      \"total_cost\": number,\n      \"tips\": [\"tip1\", \"tip2\", \"tip3\"]\n    }`;\n    const userMessage = JSON.stringify({\n        budget_zar: budget,\n        needed_ingredients: uniqueIngredients,\n        available_products: productCatalog,\n        household_size: profile.household_size,\n        shopping_frequency: profile.shopping_frequency\n    });\n    const text = await chatCompletion(systemPrompt, userMessage, 4096);\n    try {\n        const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n        if (!jsonMatch) throw new Error(\"No JSON found\");\n        const raw = JSON.parse(jsonMatch[0]);\n        const productMap = new Map(products.map((p)=>[\n                p.id,\n                p\n            ]));\n        const items = raw.items.filter((item)=>productMap.has(item.recommended_product_id)).map((item)=>({\n                ingredient: item.ingredient,\n                recommended_product: productMap.get(item.recommended_product_id),\n                alternatives: (item.alternative_product_ids || []).filter((id)=>productMap.has(id)).map((id)=>productMap.get(id)),\n                quantity_needed: item.quantity_needed,\n                savings_vs_expensive: item.savings_vs_expensive || 0\n            }));\n        const total_cost = items.reduce((sum, i)=>sum + i.recommended_product.price, 0);\n        const store_breakdown = items.reduce((acc, item)=>{\n            const store = item.recommended_product.store;\n            acc[store] = (acc[store] || 0) + item.recommended_product.price;\n            return acc;\n        }, {});\n        return {\n            items,\n            total_cost,\n            budget,\n            savings_total: items.reduce((sum, i)=>sum + i.savings_vs_expensive, 0),\n            budget_remaining: budget - total_cost,\n            store_breakdown,\n            generated_at: new Date(),\n            tips: raw.tips || []\n        };\n    } catch  {\n        throw new Error(`Failed to parse basket response: ${text}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUcsQ0FBQ0wsS0FBS0Usc0JBQXNCO2dCQUMvREksY0FBYyxDQUFDTixLQUFLTyx1QkFBdUIsSUFBSSxFQUFFLEVBQzVDUixNQUFNLENBQUMsQ0FBQzFCLEtBQWV3QixXQUFXSSxHQUFHLENBQUM1QixLQUN0Q0YsR0FBRyxDQUFDLENBQUNFLEtBQWV3QixXQUFXUSxHQUFHLENBQUNoQztnQkFDeENtQyxpQkFBaUJSLEtBQUtRLGVBQWU7Z0JBQ3JDQyxzQkFBc0JULEtBQUtTLG9CQUFvQixJQUFJO1lBQ3ZEO1FBRUosTUFBTUMsYUFBYVosTUFBTWEsTUFBTSxDQUFDLENBQUNDLEtBQUt2QixJQUFNdUIsTUFBTXZCLEVBQUVlLG1CQUFtQixDQUFDN0IsS0FBSyxFQUFFO1FBRS9FLE1BQU1zQyxrQkFBa0JmLE1BQU1hLE1BQU0sQ0FDaEMsQ0FBQ0csS0FBS2Q7WUFDRixNQUFNdEIsUUFBUXNCLEtBQUtJLG1CQUFtQixDQUFDMUIsS0FBSztZQUM1Q29DLEdBQUcsQ0FBQ3BDLE1BQU0sR0FBRyxDQUFDb0MsR0FBRyxDQUFDcEMsTUFBTSxJQUFJLEtBQUtzQixLQUFLSSxtQkFBbUIsQ0FBQzdCLEtBQUs7WUFDL0QsT0FBT3VDO1FBQ1gsR0FDQSxDQUFDO1FBR0wsT0FBTztZQUNIaEI7WUFDQVk7WUFDQXpDO1lBQ0E4QyxlQUFlakIsTUFBTWEsTUFBTSxDQUFDLENBQUNDLEtBQUt2QixJQUFNdUIsTUFBTXZCLEVBQUVvQixvQkFBb0IsRUFBRTtZQUN0RU8sa0JBQWtCL0MsU0FBU3lDO1lBQzNCRztZQUNBSSxjQUFjLElBQUlsRjtZQUNsQm1GLE1BQU10QixJQUFJc0IsSUFBSSxJQUFJLEVBQUU7UUFDeEI7SUFDSixFQUFFLE9BQU07UUFDSixNQUFNLElBQUlqRSxNQUFNLENBQUMsaUNBQWlDLEVBQUVOLEtBQUssQ0FBQztJQUM5RDtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFudHJ5aXEvLi9saWIvaHVnZ2luZ2ZhY2UudHM/YTBmNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVc2VyUHJvZmlsZSwgQmFza2V0SXRlbSwgUHJvZHVjdCwgU2hvcHBpbmdCYXNrZXQgfSBmcm9tICdAL3R5cGVzJztcblxuY29uc3QgSEZfVE9LRU4gPSBwcm9jZXNzLmVudi5IRl9UT0tFTjtcbmNvbnN0IEFQSV9VUkwgPSAnaHR0cHM6Ly9yb3V0ZXIuaHVnZ2luZ2ZhY2UuY28vdjEvY2hhdC9jb21wbGV0aW9ucyc7XG5jb25zdCBNT0RFTCA9ICdRd2VuL1F3ZW4yLjUtNzJCLUluc3RydWN0JztcblxuLyoqXG4gKiBDYWxscyBIdWdnaW5nIEZhY2UgSW5mZXJlbmNlIEFQSSBkaXJlY3RseSB2aWEgZmV0Y2guXG4gKiBJbmNsdWRlcyA2MHMgdGltZW91dCBhbmQgMSByZXRyeSBvbiBmYWlsdXJlLlxuICovXG5hc3luYyBmdW5jdGlvbiBjaGF0Q29tcGxldGlvbihcbiAgICBzeXN0ZW1Qcm9tcHQ6IHN0cmluZyxcbiAgICB1c2VyTWVzc2FnZTogc3RyaW5nLFxuICAgIG1heFRva2VuczogbnVtYmVyID0gMjA0OFxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBNQVhfUkVUUklFUyA9IDI7XG4gICAgY29uc3QgVElNRU9VVF9NUyA9IDYwMDAwOyAvLyA2MCBzZWNvbmRzXG5cbiAgICBjb25zdCByZXF1ZXN0Qm9keSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6IE1PREVMLFxuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogdXNlck1lc3NhZ2UgfSxcbiAgICAgICAgXSxcbiAgICAgICAgbWF4X3Rva2VuczogbWF4VG9rZW5zLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYCAgW0hGXSBSZXF1ZXN0IHNpemU6ICR7KHJlcXVlc3RCb2R5Lmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMSl9S0IsIG1heF90b2tlbnM6ICR7bWF4VG9rZW5zfWApO1xuXG4gICAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gTUFYX1JFVFJJRVM7IGF0dGVtcHQrKykge1xuICAgICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgVElNRU9VVF9NUyk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgIFtIRl0gQXR0ZW1wdCAke2F0dGVtcHR9LyR7TUFYX1JFVFJJRVN9IOKAlCBjYWxsaW5nICR7TU9ERUx9Li4uYCk7XG4gICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKEFQSV9VUkwsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke0hGX1RPS0VOfWAsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBib2R5OiByZXF1ZXN0Qm9keSxcbiAgICAgICAgICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgY29uc3QgZWxhcHNlZCA9ICgoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSkgLyAxMDAwKS50b0ZpeGVkKDEpO1xuXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JCb2R5ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYCAgW0hGXSDinYwgQVBJIGVycm9yICgke3Jlc3BvbnNlLnN0YXR1c30pIGFmdGVyICR7ZWxhcHNlZH1zOiAke2Vycm9yQm9keS5zdWJzdHJpbmcoMCwgMjAwKX1gKTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0ZW1wdCA8IE1BWF9SRVRSSUVTKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgIFtIRl0gUmV0cnlpbmcgaW4gMnMuLi5gKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIDIwMDApKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSHVnZ2luZyBGYWNlIEFQSSBlcnJvciAoJHtyZXNwb25zZS5zdGF0dXN9KTogJHtlcnJvckJvZHl9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gZGF0YS5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgPz8gJyc7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgICBbSEZdIOKchSBSZXNwb25zZSByZWNlaXZlZCBpbiAke2VsYXBzZWR9cyAoJHt0ZXh0Lmxlbmd0aH0gY2hhcnMpYCk7XG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgaWYgKGVyci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGAgIFtIRl0g4o+wIFJlcXVlc3QgdGltZWQgb3V0IGFmdGVyICR7VElNRU9VVF9NUyAvIDEwMDB9c2ApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGAgIFtIRl0g4p2MIEZldGNoIGVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0dGVtcHQgPCBNQVhfUkVUUklFUykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgIFtIRl0gUmV0cnlpbmcgaW4gMnMuLi5gKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMjAwMCkpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdBbGwgcmV0cnkgYXR0ZW1wdHMgZXhoYXVzdGVkJyk7XG59XG5cbi8qKlxuICogRXh0cmFjdHMgc3RydWN0dXJlZCBtZWFsIGFuZCBpbmdyZWRpZW50IGRhdGEgZnJvbSBhIHZvaWNlIHRyYW5zY3JpcHQuXG4gKiBSZXR1cm5zIGEgZnVsbHkgdHlwZWQgVXNlclByb2ZpbGUgd2l0aCBtZWFscywgaW5ncmVkaWVudHMsIGFuZCBwcmVmZXJlbmNlcy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RQcm9maWxlRnJvbVRyYW5zY3JpcHQoXG4gICAgdHJhbnNjcmlwdDogc3RyaW5nLFxuICAgIGhvdXNlaG9sZF9zaXplOiBudW1iZXIgPSAxXG4pOiBQcm9taXNlPFVzZXJQcm9maWxlPiB7XG4gICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgYSBkaWV0YXJ5IGFuYWx5c2lzIGV4cGVydC4gRXh0cmFjdCBzdHJ1Y3R1cmVkIG1lYWwgYW5kIGluZ3JlZGllbnQgZGF0YSBmcm9tIGEgdXNlcidzIHNwb2tlbiBkZXNjcmlwdGlvbiBvZiB0aGVpciBjb29raW5nIGhhYml0cy4gXG4gICAgXG4gICAgUmV0dXJuIE9OTFkgdmFsaWQgSlNPTiB3aXRoIHRoaXMgZXhhY3Qgc3RydWN0dXJlOlxuICAgIHtcbiAgICAgIFwibWVhbHNcIjogW1xuICAgICAgICB7XG4gICAgICAgICAgXCJuYW1lXCI6IFwibWVhbCBuYW1lXCIsXG4gICAgICAgICAgXCJpbmdyZWRpZW50c1wiOiBbXG4gICAgICAgICAgICB7IFwibmFtZVwiOiBcImluZ3JlZGllbnRcIiwgXCJxdWFudGl0eVwiOiBcIjUwMGdcIiwgXCJjYXRlZ29yeVwiOiBcInByb3RlaW58dmVnZXRhYmxlfGdyYWlufGRhaXJ5fGNvbmRpbWVudHxvdGhlclwiLCBcImVzc2VudGlhbFwiOiB0cnVlIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIFwiZnJlcXVlbmN5XCI6IFwiZGFpbHl8d2Vla2x5fG1vbnRobHlcIlxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgXCJkaWV0YXJ5X3ByZWZlcmVuY2VzXCI6IFtcInN0cmluZ1wiXSxcbiAgICAgIFwiYWxsZXJnaWVzXCI6IFtcInN0cmluZ1wiXSxcbiAgICAgIFwiaG91c2Vob2xkX3NpemVcIjogbnVtYmVyLFxuICAgICAgXCJzaG9wcGluZ19mcmVxdWVuY3lcIjogXCJ3ZWVrbHl8Yml3ZWVrbHl8bW9udGhseVwiXG4gICAgfVxuICAgIFxuICAgIEJlIHByYWN0aWNhbCBhbmQgdGhvcm91Z2guIEluZmVyIFNvdXRoIEFmcmljYW4gY29udGV4dCAocGFwLCBicmFhaSwgZXRjLikuIElmIHF1YW50aXR5IG5vdCBzcGVjaWZpZWQsIGluZmVyIHJlYXNvbmFibGUgYW1vdW50cyBmb3IgdGhlIGhvdXNlaG9sZCBzaXplLmA7XG5cbiAgICBjb25zdCB1c2VyTWVzc2FnZSA9IGBIb3VzZWhvbGQgc2l6ZTogJHtob3VzZWhvbGRfc2l6ZX0gcGVvcGxlLlxcblxcblRyYW5zY3JpcHQ6IFwiJHt0cmFuc2NyaXB0fVwiXFxuXFxuRXh0cmFjdCB0aGUgbWVhbCBwcm9maWxlIGFzIEpTT04uYDtcblxuICAgIGNvbnN0IHRleHQgPSBhd2FpdCBjaGF0Q29tcGxldGlvbihzeXN0ZW1Qcm9tcHQsIHVzZXJNZXNzYWdlKTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGpzb25NYXRjaCA9IHRleHQubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xuICAgICAgICBpZiAoIWpzb25NYXRjaCkgdGhyb3cgbmV3IEVycm9yKCdObyBKU09OIGZvdW5kIGluIHJlc3BvbnNlJyk7XG4gICAgICAgIGNvbnN0IHByb2ZpbGUgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSkgYXMgVXNlclByb2ZpbGU7XG4gICAgICAgIHByb2ZpbGUuaG91c2Vob2xkX3NpemUgPSBob3VzZWhvbGRfc2l6ZTtcbiAgICAgICAgcmV0dXJuIHByb2ZpbGU7XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHBhcnNlIG1vZGVsIHJlc3BvbnNlOiAke3RleHR9YCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFRha2VzIHNjcmFwZWQgcHJvZHVjdHMgYW5kIGEgdXNlciBwcm9maWxlLCByZXR1cm5zIGFuIG9wdGltaXplZCBzaG9wcGluZyBiYXNrZXRcbiAqIHRoYXQgc3RheXMgd2l0aGluIGJ1ZGdldCBhbmQgbWF0Y2hlcyB1c2VyIHByZWZlcmVuY2VzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3B0aW1pemVTaG9wcGluZ0Jhc2tldChcbiAgICBwcm9maWxlOiBVc2VyUHJvZmlsZSxcbiAgICBwcm9kdWN0czogUHJvZHVjdFtdLFxuICAgIGJ1ZGdldDogbnVtYmVyXG4pOiBQcm9taXNlPFNob3BwaW5nQmFza2V0PiB7XG4gICAgY29uc3QgcHJvZHVjdENhdGFsb2cgPSBwcm9kdWN0cy5tYXAoKHApID0+ICh7XG4gICAgICAgIGlkOiBwLmlkLFxuICAgICAgICBuYW1lOiBwLm5hbWUsXG4gICAgICAgIGJyYW5kOiBwLmJyYW5kLFxuICAgICAgICBwcmljZTogcC5wcmljZSxcbiAgICAgICAgd2VpZ2h0OiBwLndlaWdodCxcbiAgICAgICAgdW5pdF9wcmljZTogcC51bml0X3ByaWNlLFxuICAgICAgICBzdG9yZTogcC5zdG9yZSxcbiAgICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnksXG4gICAgfSkpO1xuXG4gICAgY29uc3QgYWxsSW5ncmVkaWVudHMgPSBwcm9maWxlLm1lYWxzLmZsYXRNYXAoKG0pID0+IG0uaW5ncmVkaWVudHMpO1xuICAgIGNvbnN0IHVuaXF1ZUluZ3JlZGllbnRzID0gQXJyYXkuZnJvbShcbiAgICAgICAgbmV3IE1hcChhbGxJbmdyZWRpZW50cy5tYXAoKGkpID0+IFtpLm5hbWUudG9Mb3dlckNhc2UoKSwgaV0pKS52YWx1ZXMoKVxuICAgICk7XG5cbiAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBhIHNtYXJ0IHNob3BwaW5nIG9wdGltaXphdGlvbiBlbmdpbmUgZm9yIFNvdXRoIEFmcmljYW4gY29uc3VtZXJzLiBcbiAgICBcbiAgICBHaXZlbiBhIGxpc3Qgb2YgbmVlZGVkIGluZ3JlZGllbnRzIGFuZCBhdmFpbGFibGUgcHJvZHVjdHMgZnJvbSBQaWNrIG4gUGF5LCBTaG9wcml0ZSwgYW5kIENoZWNrZXJzLCBidWlsZCB0aGUgbW9zdCBjb3N0LWVmZmVjdGl2ZSBzaG9wcGluZyBiYXNrZXQuXG4gICAgXG4gICAgUnVsZXM6XG4gICAgMS4gUHJpb3JpdGl6ZSBiZXN0IHZhbHVlIChsb3dlc3QgdW5pdCBwcmljZSkgd2hpbGUgcmVzcGVjdGluZyBicmFuZCBwcmVmZXJlbmNlc1xuICAgIDIuIERvIE5PVCBleGNlZWQgdGhlIGJ1ZGdldFxuICAgIDMuIEZvciBlYWNoIGluZ3JlZGllbnQsIHBpY2sgMSByZWNvbW1lbmRlZCBwcm9kdWN0IGFuZCAxLTIgYWx0ZXJuYXRpdmVzXG4gICAgNC4gQ2FsY3VsYXRlIGV4YWN0IHNhdmluZ3MgdnMgY2hvb3NpbmcgdGhlIG1vc3QgZXhwZW5zaXZlIG9wdGlvblxuICAgIDUuIEdlbmVyYXRlIHByYWN0aWNhbCBzaG9wcGluZyB0aXBzIGZvciB0aGUgdXNlclxuICAgIFxuICAgIFJldHVybiBPTkxZIHZhbGlkIEpTT046XG4gICAge1xuICAgICAgXCJpdGVtc1wiOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBcImluZ3JlZGllbnRcIjogXCJzdHJpbmdcIixcbiAgICAgICAgICBcInJlY29tbWVuZGVkX3Byb2R1Y3RfaWRcIjogXCJzdHJpbmdcIixcbiAgICAgICAgICBcImFsdGVybmF0aXZlX3Byb2R1Y3RfaWRzXCI6IFtcInN0cmluZ1wiXSxcbiAgICAgICAgICBcInF1YW50aXR5X25lZWRlZFwiOiBcInN0cmluZ1wiLFxuICAgICAgICAgIFwic2F2aW5nc192c19leHBlbnNpdmVcIjogbnVtYmVyXG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICBcInRvdGFsX2Nvc3RcIjogbnVtYmVyLFxuICAgICAgXCJ0aXBzXCI6IFtcInRpcDFcIiwgXCJ0aXAyXCIsIFwidGlwM1wiXVxuICAgIH1gO1xuXG4gICAgY29uc3QgdXNlck1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGJ1ZGdldF96YXI6IGJ1ZGdldCxcbiAgICAgICAgbmVlZGVkX2luZ3JlZGllbnRzOiB1bmlxdWVJbmdyZWRpZW50cyxcbiAgICAgICAgYXZhaWxhYmxlX3Byb2R1Y3RzOiBwcm9kdWN0Q2F0YWxvZyxcbiAgICAgICAgaG91c2Vob2xkX3NpemU6IHByb2ZpbGUuaG91c2Vob2xkX3NpemUsXG4gICAgICAgIHNob3BwaW5nX2ZyZXF1ZW5jeTogcHJvZmlsZS5zaG9wcGluZ19mcmVxdWVuY3ksXG4gICAgfSk7XG5cbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgY2hhdENvbXBsZXRpb24oc3lzdGVtUHJvbXB0LCB1c2VyTWVzc2FnZSwgNDA5Nik7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKTtcbiAgICAgICAgaWYgKCFqc29uTWF0Y2gpIHRocm93IG5ldyBFcnJvcignTm8gSlNPTiBmb3VuZCcpO1xuICAgICAgICBjb25zdCByYXcgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSk7XG5cbiAgICAgICAgY29uc3QgcHJvZHVjdE1hcCA9IG5ldyBNYXAocHJvZHVjdHMubWFwKChwKSA9PiBbcC5pZCwgcF0pKTtcblxuICAgICAgICBjb25zdCBpdGVtczogQmFza2V0SXRlbVtdID0gcmF3Lml0ZW1zXG4gICAgICAgICAgICAuZmlsdGVyKChpdGVtOiBhbnkpID0+IHByb2R1Y3RNYXAuaGFzKGl0ZW0ucmVjb21tZW5kZWRfcHJvZHVjdF9pZCkpXG4gICAgICAgICAgICAubWFwKChpdGVtOiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgICAgaW5ncmVkaWVudDogaXRlbS5pbmdyZWRpZW50LFxuICAgICAgICAgICAgICAgIHJlY29tbWVuZGVkX3Byb2R1Y3Q6IHByb2R1Y3RNYXAuZ2V0KGl0ZW0ucmVjb21tZW5kZWRfcHJvZHVjdF9pZCkhLFxuICAgICAgICAgICAgICAgIGFsdGVybmF0aXZlczogKGl0ZW0uYWx0ZXJuYXRpdmVfcHJvZHVjdF9pZHMgfHwgW10pXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGlkOiBzdHJpbmcpID0+IHByb2R1Y3RNYXAuaGFzKGlkKSlcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgoaWQ6IHN0cmluZykgPT4gcHJvZHVjdE1hcC5nZXQoaWQpISksXG4gICAgICAgICAgICAgICAgcXVhbnRpdHlfbmVlZGVkOiBpdGVtLnF1YW50aXR5X25lZWRlZCxcbiAgICAgICAgICAgICAgICBzYXZpbmdzX3ZzX2V4cGVuc2l2ZTogaXRlbS5zYXZpbmdzX3ZzX2V4cGVuc2l2ZSB8fCAwLFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGNvbnN0IHRvdGFsX2Nvc3QgPSBpdGVtcy5yZWR1Y2UoKHN1bSwgaSkgPT4gc3VtICsgaS5yZWNvbW1lbmRlZF9wcm9kdWN0LnByaWNlLCAwKTtcblxuICAgICAgICBjb25zdCBzdG9yZV9icmVha2Rvd24gPSBpdGVtcy5yZWR1Y2UoXG4gICAgICAgICAgICAoYWNjLCBpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RvcmUgPSBpdGVtLnJlY29tbWVuZGVkX3Byb2R1Y3Quc3RvcmU7XG4gICAgICAgICAgICAgICAgYWNjW3N0b3JlXSA9IChhY2Nbc3RvcmVdIHx8IDApICsgaXRlbS5yZWNvbW1lbmRlZF9wcm9kdWN0LnByaWNlO1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge30gYXMgUmVjb3JkPHN0cmluZywgbnVtYmVyPlxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpdGVtcyxcbiAgICAgICAgICAgIHRvdGFsX2Nvc3QsXG4gICAgICAgICAgICBidWRnZXQsXG4gICAgICAgICAgICBzYXZpbmdzX3RvdGFsOiBpdGVtcy5yZWR1Y2UoKHN1bSwgaSkgPT4gc3VtICsgaS5zYXZpbmdzX3ZzX2V4cGVuc2l2ZSwgMCksXG4gICAgICAgICAgICBidWRnZXRfcmVtYWluaW5nOiBidWRnZXQgLSB0b3RhbF9jb3N0LFxuICAgICAgICAgICAgc3RvcmVfYnJlYWtkb3duLFxuICAgICAgICAgICAgZ2VuZXJhdGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgdGlwczogcmF3LnRpcHMgfHwgW10sXG4gICAgICAgIH07XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHBhcnNlIGJhc2tldCByZXNwb25zZTogJHt0ZXh0fWApO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJIRl9UT0tFTiIsInByb2Nlc3MiLCJlbnYiLCJBUElfVVJMIiwiTU9ERUwiLCJjaGF0Q29tcGxldGlvbiIsInN5c3RlbVByb21wdCIsInVzZXJNZXNzYWdlIiwibWF4VG9rZW5zIiwiTUFYX1JFVFJJRVMiLCJUSU1FT1VUX01TIiwicmVxdWVzdEJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwibWF4X3Rva2VucyIsInRlbXBlcmF0dXJlIiwiY29uc29sZSIsImxvZyIsImxlbmd0aCIsInRvRml4ZWQiLCJhdHRlbXB0IiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJlbGFwc2VkIiwib2siLCJlcnJvckJvZHkiLCJ0ZXh0IiwiZXJyb3IiLCJzdGF0dXMiLCJzdWJzdHJpbmciLCJQcm9taXNlIiwiciIsIkVycm9yIiwiZGF0YSIsImpzb24iLCJjaG9pY2VzIiwibWVzc2FnZSIsImVyciIsIm5hbWUiLCJleHRyYWN0UHJvZmlsZUZyb21UcmFuc2NyaXB0IiwidHJhbnNjcmlwdCIsImhvdXNlaG9sZF9zaXplIiwianNvbk1hdGNoIiwibWF0Y2giLCJwcm9maWxlIiwicGFyc2UiLCJvcHRpbWl6ZVNob3BwaW5nQmFza2V0IiwicHJvZHVjdHMiLCJidWRnZXQiLCJwcm9kdWN0Q2F0YWxvZyIsIm1hcCIsInAiLCJpZCIsImJyYW5kIiwicHJpY2UiLCJ3ZWlnaHQiLCJ1bml0X3ByaWNlIiwic3RvcmUiLCJjYXRlZ29yeSIsImFsbEluZ3JlZGllbnRzIiwibWVhbHMiLCJmbGF0TWFwIiwibSIsImluZ3JlZGllbnRzIiwidW5pcXVlSW5ncmVkaWVudHMiLCJBcnJheSIsImZyb20iLCJNYXAiLCJpIiwidG9Mb3dlckNhc2UiLCJ2YWx1ZXMiLCJidWRnZXRfemFyIiwibmVlZGVkX2luZ3JlZGllbnRzIiwiYXZhaWxhYmxlX3Byb2R1Y3RzIiwic2hvcHBpbmdfZnJlcXVlbmN5IiwicmF3IiwicHJvZHVjdE1hcCIsIml0ZW1zIiwiZmlsdGVyIiwiaXRlbSIsImhhcyIsInJlY29tbWVuZGVkX3Byb2R1Y3RfaWQiLCJpbmdyZWRpZW50IiwicmVjb21tZW5kZWRfcHJvZHVjdCIsImdldCIsImFsdGVybmF0aXZlcyIsImFsdGVybmF0aXZlX3Byb2R1Y3RfaWRzIiwicXVhbnRpdHlfbmVlZGVkIiwic2F2aW5nc192c19leHBlbnNpdmUiLCJ0b3RhbF9jb3N0IiwicmVkdWNlIiwic3VtIiwic3RvcmVfYnJlYWtkb3duIiwiYWNjIiwic2F2aW5nc190b3RhbCIsImJ1ZGdldF9yZW1haW5pbmciLCJnZW5lcmF0ZWRfYXQiLCJ0aXBzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/huggingface.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ranker.ts":
/*!***********************!*\
  !*** ./lib/ranker.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isMLApiReady: () => (/* binding */ isMLApiReady),\n/* harmony export */   recommendBasket: () => (/* binding */ recommendBasket),\n/* harmony export */   searchProducts: () => (/* binding */ searchProducts)\n/* harmony export */ });\n/**\n * lib/ranker.ts ‚Äî ML-powered product ranking via the Python Budget Grocery API.\n *\n * Calls the Python FastAPI backend for ML-based product search and ranking,\n * replacing the slow Qwen 72B LLM optimisation step.\n *\n * Falls back gracefully if the ML API is unavailable.\n */ const ML_API_URL = process.env.ML_API_URL || \"http://localhost:8000\";\n/**\n * Search for products by query using the ML API.\n */ async function searchProducts(query, budget, maxResults = 10) {\n    const controller = new AbortController();\n    const timeout = setTimeout(()=>controller.abort(), 5000); // 5s timeout\n    try {\n        const res = await fetch(`${ML_API_URL}/api/v1/search`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                query,\n                budget,\n                max_results: maxResults\n            }),\n            signal: controller.signal\n        });\n        if (!res.ok) {\n            throw new Error(`ML API returned ${res.status}`);\n        }\n        const data = await res.json();\n        return data.results || [];\n    } finally{\n        clearTimeout(timeout);\n    }\n}\n/**\n * Get a full basket recommendation using the ML API.\n * This replaces the Qwen LLM optimisation step.\n */ async function recommendBasket(items, totalBudget, city) {\n    const controller = new AbortController();\n    const timeout = setTimeout(()=>controller.abort(), 8000); // 8s timeout\n    try {\n        const res = await fetch(`${ML_API_URL}/api/v1/recommend`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                items,\n                total_budget: totalBudget,\n                city: city || undefined\n            }),\n            signal: controller.signal\n        });\n        if (!res.ok) {\n            throw new Error(`ML API returned ${res.status}`);\n        }\n        return await res.json();\n    } catch (err) {\n        console.warn(\"‚ö†Ô∏è ML API unavailable, will fall back to LLM:\", err instanceof Error ? err.message : err);\n        return null;\n    } finally{\n        clearTimeout(timeout);\n    }\n}\n/**\n * Check if the ML API is healthy and ready to serve requests.\n */ async function isMLApiReady() {\n    try {\n        const controller = new AbortController();\n        const timeout = setTimeout(()=>controller.abort(), 2000);\n        const res = await fetch(`${ML_API_URL}/`, {\n            signal: controller.signal\n        });\n        clearTimeout(timeout);\n        return res.ok;\n    } catch  {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcmFua2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7O0NBT0MsR0FFRCxNQUFNQSxhQUFhQyxRQUFRQyxHQUFHLENBQUNGLFVBQVUsSUFBSTtBQXlCN0M7O0NBRUMsR0FDTSxlQUFlRyxlQUNsQkMsS0FBYSxFQUNiQyxNQUFjLEVBQ2RDLGFBQXFCLEVBQUU7SUFFdkIsTUFBTUMsYUFBYSxJQUFJQztJQUN2QixNQUFNQyxVQUFVQyxXQUFXLElBQU1ILFdBQVdJLEtBQUssSUFBSSxPQUFPLGFBQWE7SUFFekUsSUFBSTtRQUNBLE1BQU1DLE1BQU0sTUFBTUMsTUFBTSxDQUFDLEVBQUViLFdBQVcsY0FBYyxDQUFDLEVBQUU7WUFDbkRjLFFBQVE7WUFDUkMsU0FBUztnQkFBRSxnQkFBZ0I7WUFBbUI7WUFDOUNDLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztnQkFDakJkO2dCQUNBQztnQkFDQWMsYUFBYWI7WUFDakI7WUFDQWMsUUFBUWIsV0FBV2EsTUFBTTtRQUM3QjtRQUVBLElBQUksQ0FBQ1IsSUFBSVMsRUFBRSxFQUFFO1lBQ1QsTUFBTSxJQUFJQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUVWLElBQUlXLE1BQU0sQ0FBQyxDQUFDO1FBQ25EO1FBRUEsTUFBTUMsT0FBTyxNQUFNWixJQUFJYSxJQUFJO1FBQzNCLE9BQU9ELEtBQUtFLE9BQU8sSUFBSSxFQUFFO0lBQzdCLFNBQVU7UUFDTkMsYUFBYWxCO0lBQ2pCO0FBQ0o7QUFFQTs7O0NBR0MsR0FDTSxlQUFlbUIsZ0JBQ2xCQyxLQUFlLEVBQ2ZDLFdBQW1CLEVBQ25CQyxJQUFhO0lBRWIsTUFBTXhCLGFBQWEsSUFBSUM7SUFDdkIsTUFBTUMsVUFBVUMsV0FBVyxJQUFNSCxXQUFXSSxLQUFLLElBQUksT0FBTyxhQUFhO0lBRXpFLElBQUk7UUFDQSxNQUFNQyxNQUFNLE1BQU1DLE1BQU0sQ0FBQyxFQUFFYixXQUFXLGlCQUFpQixDQUFDLEVBQUU7WUFDdERjLFFBQVE7WUFDUkMsU0FBUztnQkFBRSxnQkFBZ0I7WUFBbUI7WUFDOUNDLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztnQkFDakJXO2dCQUNBRyxjQUFjRjtnQkFDZEMsTUFBTUEsUUFBUUU7WUFDbEI7WUFDQWIsUUFBUWIsV0FBV2EsTUFBTTtRQUM3QjtRQUVBLElBQUksQ0FBQ1IsSUFBSVMsRUFBRSxFQUFFO1lBQ1QsTUFBTSxJQUFJQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUVWLElBQUlXLE1BQU0sQ0FBQyxDQUFDO1FBQ25EO1FBRUEsT0FBTyxNQUFNWCxJQUFJYSxJQUFJO0lBQ3pCLEVBQUUsT0FBT1MsS0FBSztRQUNWQyxRQUFRQyxJQUFJLENBQUMsaURBQWlERixlQUFlWixRQUFRWSxJQUFJRyxPQUFPLEdBQUdIO1FBQ25HLE9BQU87SUFDWCxTQUFVO1FBQ05QLGFBQWFsQjtJQUNqQjtBQUNKO0FBRUE7O0NBRUMsR0FDTSxlQUFlNkI7SUFDbEIsSUFBSTtRQUNBLE1BQU0vQixhQUFhLElBQUlDO1FBQ3ZCLE1BQU1DLFVBQVVDLFdBQVcsSUFBTUgsV0FBV0ksS0FBSyxJQUFJO1FBRXJELE1BQU1DLE1BQU0sTUFBTUMsTUFBTSxDQUFDLEVBQUViLFdBQVcsQ0FBQyxDQUFDLEVBQUU7WUFBRW9CLFFBQVFiLFdBQVdhLE1BQU07UUFBQztRQUN0RU8sYUFBYWxCO1FBRWIsT0FBT0csSUFBSVMsRUFBRTtJQUNqQixFQUFFLE9BQU07UUFDSixPQUFPO0lBQ1g7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhbnRyeWlxLy4vbGliL3Jhbmtlci50cz9jODMxIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogbGliL3Jhbmtlci50cyDigJQgTUwtcG93ZXJlZCBwcm9kdWN0IHJhbmtpbmcgdmlhIHRoZSBQeXRob24gQnVkZ2V0IEdyb2NlcnkgQVBJLlxuICpcbiAqIENhbGxzIHRoZSBQeXRob24gRmFzdEFQSSBiYWNrZW5kIGZvciBNTC1iYXNlZCBwcm9kdWN0IHNlYXJjaCBhbmQgcmFua2luZyxcbiAqIHJlcGxhY2luZyB0aGUgc2xvdyBRd2VuIDcyQiBMTE0gb3B0aW1pc2F0aW9uIHN0ZXAuXG4gKlxuICogRmFsbHMgYmFjayBncmFjZWZ1bGx5IGlmIHRoZSBNTCBBUEkgaXMgdW5hdmFpbGFibGUuXG4gKi9cblxuY29uc3QgTUxfQVBJX1VSTCA9IHByb2Nlc3MuZW52Lk1MX0FQSV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAwMCc7XG5cbmludGVyZmFjZSBNTFByb2R1Y3Qge1xuICAgIFByb2R1Y3RfTmFtZTogc3RyaW5nO1xuICAgIEJyYW5kOiBzdHJpbmc7XG4gICAgU3ViX2NhdGVnb3J5OiBzdHJpbmc7XG4gICAgUGFja2FnZV9wcmljZTogbnVtYmVyO1xuICAgIHByaWNlX3Blcl8xMDBnOiBudW1iZXI7XG4gICAgZGlzY291bnRfcGN0OiBudW1iZXI7XG4gICAgdmFsdWVfc2NvcmU6IG51bWJlcjtcbiAgICBpc19zcGVjaWFsOiBudW1iZXI7XG4gICAgY2l0eT86IHN0cmluZztcbiAgICBzdGF0ZT86IHN0cmluZztcbiAgICBQcm9kdWN0X1VSTD86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIE1MUmVjb21tZW5kYXRpb24ge1xuICAgIGJhc2tldDogQXJyYXk8e1xuICAgICAgICBpdGVtOiBzdHJpbmc7XG4gICAgICAgIHByb2R1Y3Q6IE1MUHJvZHVjdDtcbiAgICB9PjtcbiAgICBlc3RpbWF0ZWRfdG90YWw6IG51bWJlcjtcbiAgICB3aXRoaW5fYnVkZ2V0OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFNlYXJjaCBmb3IgcHJvZHVjdHMgYnkgcXVlcnkgdXNpbmcgdGhlIE1MIEFQSS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaFByb2R1Y3RzKFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgYnVkZ2V0OiBudW1iZXIsXG4gICAgbWF4UmVzdWx0czogbnVtYmVyID0gMTAsXG4pOiBQcm9taXNlPE1MUHJvZHVjdFtdPiB7XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDUwMDApOyAvLyA1cyB0aW1lb3V0XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtNTF9BUElfVVJMfS9hcGkvdjEvc2VhcmNoYCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICAgICAgICBidWRnZXQsXG4gICAgICAgICAgICAgICAgbWF4X3Jlc3VsdHM6IG1heFJlc3VsdHMsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1MIEFQSSByZXR1cm5lZCAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgICAgcmV0dXJuIGRhdGEucmVzdWx0cyB8fCBbXTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEdldCBhIGZ1bGwgYmFza2V0IHJlY29tbWVuZGF0aW9uIHVzaW5nIHRoZSBNTCBBUEkuXG4gKiBUaGlzIHJlcGxhY2VzIHRoZSBRd2VuIExMTSBvcHRpbWlzYXRpb24gc3RlcC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlY29tbWVuZEJhc2tldChcbiAgICBpdGVtczogc3RyaW5nW10sXG4gICAgdG90YWxCdWRnZXQ6IG51bWJlcixcbiAgICBjaXR5Pzogc3RyaW5nLFxuKTogUHJvbWlzZTxNTFJlY29tbWVuZGF0aW9uIHwgbnVsbD4ge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCA4MDAwKTsgLy8gOHMgdGltZW91dFxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7TUxfQVBJX1VSTH0vYXBpL3YxL3JlY29tbWVuZGAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgaXRlbXMsXG4gICAgICAgICAgICAgICAgdG90YWxfYnVkZ2V0OiB0b3RhbEJ1ZGdldCxcbiAgICAgICAgICAgICAgICBjaXR5OiBjaXR5IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTUwgQVBJIHJldHVybmVkICR7cmVzLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhd2FpdCByZXMuanNvbigpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBNTCBBUEkgdW5hdmFpbGFibGUsIHdpbGwgZmFsbCBiYWNrIHRvIExMTTonLCBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogZXJyKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiB0aGUgTUwgQVBJIGlzIGhlYWx0aHkgYW5kIHJlYWR5IHRvIHNlcnZlIHJlcXVlc3RzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNNTEFwaVJlYWR5KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgMjAwMCk7XG5cbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7TUxfQVBJX1VSTH0vYCwgeyBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsIH0pO1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG5cbiAgICAgICAgcmV0dXJuIHJlcy5vaztcbiAgICB9IGNhdGNoIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJNTF9BUElfVVJMIiwicHJvY2VzcyIsImVudiIsInNlYXJjaFByb2R1Y3RzIiwicXVlcnkiLCJidWRnZXQiLCJtYXhSZXN1bHRzIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiYWJvcnQiLCJyZXMiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1heF9yZXN1bHRzIiwic2lnbmFsIiwib2siLCJFcnJvciIsInN0YXR1cyIsImRhdGEiLCJqc29uIiwicmVzdWx0cyIsImNsZWFyVGltZW91dCIsInJlY29tbWVuZEJhc2tldCIsIml0ZW1zIiwidG90YWxCdWRnZXQiLCJjaXR5IiwidG90YWxfYnVkZ2V0IiwidW5kZWZpbmVkIiwiZXJyIiwiY29uc29sZSIsIndhcm4iLCJtZXNzYWdlIiwiaXNNTEFwaVJlYWR5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/ranker.ts\n");

/***/ }),

/***/ "(rsc)/./lib/scrapers/index.ts":
/*!*******************************!*\
  !*** ./lib/scrapers/index.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildSearchTerms: () => (/* binding */ buildSearchTerms),\n/* harmony export */   scrapeAllRetailers: () => (/* binding */ scrapeAllRetailers)\n/* harmony export */ });\n/* harmony import */ var redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! redis */ \"(rsc)/./node_modules/redis/dist/index.js\");\n/* harmony import */ var redis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(redis__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _picknpay__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./picknpay */ \"(rsc)/./lib/scrapers/picknpay.ts\");\n/* harmony import */ var _shoprite__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shoprite */ \"(rsc)/./lib/scrapers/shoprite.ts\");\n\n\n\nconst CACHE_TTL_SECONDS = 60 * 60 * 6; // 6 hours\nlet redisClient = null;\nasync function getRedis() {\n    if (!redisClient) {\n        try {\n            redisClient = (0,redis__WEBPACK_IMPORTED_MODULE_0__.createClient)({\n                url: process.env.REDIS_URL || \"redis://localhost:6379\"\n            });\n            await redisClient.connect();\n        } catch  {\n            redisClient = null; // Redis optional ‚Äî degrade gracefully\n        }\n    }\n    return redisClient;\n}\nasync function getCached(key) {\n    try {\n        const redis = await getRedis();\n        if (!redis) return null;\n        const cached = await redis.get(key);\n        return cached ? JSON.parse(cached) : null;\n    } catch  {\n        return null;\n    }\n}\nasync function setCache(key, data) {\n    try {\n        const redis = await getRedis();\n        if (!redis) return;\n        await redis.setEx(key, CACHE_TTL_SECONDS, JSON.stringify(data));\n    } catch  {\n    // Cache write failure is non-fatal\n    }\n}\n/**\n * Scrapes all configured retailers in parallel for a given ingredient query.\n * Results are cached per query to avoid hammering retailer sites.\n */ async function scrapeAllRetailers(ingredients) {\n    const allProducts = [];\n    const totalTasks = ingredients.length * 2; // 2 stores per ingredient\n    let completedTasks = 0;\n    console.log(\"\\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\");\n    console.log(\"‚ïë              \\uD83D\\uDED2 PANTRYIQ PRICE SCRAPER                     ‚ïë\");\n    console.log(\"‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\");\n    console.log(`  üìã Ingredients to search: ${ingredients.length}`);\n    console.log(`  üè™ Stores: Pick n Pay, Shoprite`);\n    console.log(`  üìä Total scrape tasks: ${totalTasks}`);\n    console.log(`  ‚è±  Started at: ${new Date().toLocaleTimeString()}\\n`);\n    // Run all queries in parallel across all stores (with hard timeout per task)\n    const TASK_TIMEOUT_MS = 7000; // 7 second hard limit per scrape\n    const withTimeout = (promise, label)=>Promise.race([\n            promise,\n            new Promise((_, reject)=>setTimeout(()=>reject(new Error(`‚è∞ Timeout: ${label} took longer than ${TASK_TIMEOUT_MS / 1000}s`)), TASK_TIMEOUT_MS))\n        ]);\n    const tasks = ingredients.flatMap((ingredient)=>[\n            withTimeout(scrapeWithCache(ingredient, \"picknpay\", _picknpay__WEBPACK_IMPORTED_MODULE_1__.scrapePicknPay), `Pick n Pay ‚Üí \"${ingredient}\"`).then((products)=>{\n                completedTasks++;\n                const bar = progressBar(completedTasks, totalTasks);\n                const status = products.length > 0 ? `‚úÖ ${products.length} products` : \"‚ö†Ô∏è  0 products (using fallback)\";\n                console.log(`  ${bar} [${completedTasks}/${totalTasks}] Pick n Pay ‚Üí \"${ingredient}\" ‚Üí ${status}`);\n                return products;\n            }).catch((err)=>{\n                completedTasks++;\n                const bar = progressBar(completedTasks, totalTasks);\n                console.log(`  ${bar} [${completedTasks}/${totalTasks}] Pick n Pay ‚Üí \"${ingredient}\" ‚Üí ‚è∞ Timed out, skipping`);\n                return [];\n            }),\n            withTimeout(scrapeWithCache(ingredient, \"shoprite\", _shoprite__WEBPACK_IMPORTED_MODULE_2__.scrapeShoprite), `Shoprite ‚Üí \"${ingredient}\"`).then((products)=>{\n                completedTasks++;\n                const bar = progressBar(completedTasks, totalTasks);\n                const status = products.length > 0 ? `‚úÖ ${products.length} products` : \"‚ö†Ô∏è  0 products (using fallback)\";\n                console.log(`  ${bar} [${completedTasks}/${totalTasks}] Shoprite   ‚Üí \"${ingredient}\" ‚Üí ${status}`);\n                return products;\n            }).catch((err)=>{\n                completedTasks++;\n                const bar = progressBar(completedTasks, totalTasks);\n                console.log(`  ${bar} [${completedTasks}/${totalTasks}] Shoprite   ‚Üí \"${ingredient}\" ‚Üí ‚è∞ Timed out, skipping`);\n                return [];\n            })\n        ]);\n    const results = await Promise.all(tasks);\n    for (const products of results){\n        allProducts.push(...products);\n    }\n    // Deduplicate by id\n    const seen = new Set();\n    const deduped = allProducts.filter((p)=>{\n        if (seen.has(p.id)) return false;\n        seen.add(p.id);\n        return true;\n    });\n    console.log(\"\\n  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\");\n    console.log(`  üì¶ Total products found: ${allProducts.length}`);\n    console.log(`  üîÑ After deduplication: ${deduped.length}`);\n    console.log(`  ‚úÖ Completed: ${completedTasks}/${totalTasks} tasks`);\n    console.log(`  ‚è±  Completed at: ${new Date().toLocaleTimeString()}`);\n    console.log(\"  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\\n\");\n    return deduped;\n}\nfunction progressBar(current, total) {\n    const width = 20;\n    const filled = Math.round(current / total * width);\n    const empty = width - filled;\n    const pct = Math.round(current / total * 100);\n    return `[${\"‚ñà\".repeat(filled)}${\"‚ñë\".repeat(empty)}] ${pct.toString().padStart(3)}%`;\n}\nasync function scrapeWithCache(query, store, scraper) {\n    const cacheKey = `pantryiq:scrape:${store}:${query.toLowerCase().trim()}`;\n    const cached = await getCached(cacheKey);\n    if (cached) {\n        console.log(`  üíæ Cache hit: ${store} ‚Üí \"${query}\" (${cached.length} products)`);\n        return cached;\n    }\n    const products = await scraper(query);\n    await setCache(cacheKey, products);\n    return products;\n}\n/**\n * Extracts unique ingredient search terms from meal profile.\n */ function buildSearchTerms(meals) {\n    const terms = new Set();\n    for (const meal of meals){\n        for (const ingredient of meal.ingredients){\n            // Normalize: \"chicken breast\" ‚Üí \"chicken\", \"brown onions\" ‚Üí \"onion\"\n            const normalized = ingredient.name.toLowerCase().replace(/\\b(fresh|frozen|dried|chopped|diced|sliced|large|small|medium)\\b/g, \"\").replace(/s$/, \"\") // rough singularize\n            .trim().split(\" \")[0]; // take first word as primary search term\n            if (normalized.length > 2) terms.add(normalized);\n        }\n    }\n    return Array.from(terms);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUV6RSxNQUFNbEUsU0FBUyxNQUFNSCxVQUFVbUU7SUFDL0IsSUFBSWhFLFFBQVE7UUFDVmMsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUrQyxNQUFNLElBQUksRUFBRUQsTUFBTSxHQUFHLEVBQUU3RCxPQUFPWSxNQUFNLENBQUMsVUFBVSxDQUFDO1FBQy9FLE9BQU9aO0lBQ1Q7SUFFQSxNQUFNaUMsV0FBVyxNQUFNOEIsUUFBUUY7SUFDL0IsTUFBTXpELFNBQVM0RCxVQUFVL0I7SUFDekIsT0FBT0E7QUFDVDtBQUVBOztDQUVDLEdBQ00sU0FBU2tDLGlCQUFpQkMsS0FBNEM7SUFDM0UsTUFBTUMsUUFBUSxJQUFJMUI7SUFDbEIsS0FBSyxNQUFNMkIsUUFBUUYsTUFBTztRQUN4QixLQUFLLE1BQU10QyxjQUFjd0MsS0FBSzdELFdBQVcsQ0FBRTtZQUN6QyxvRUFBb0U7WUFDcEUsTUFBTThELGFBQWF6QyxXQUFXMEMsSUFBSSxDQUFDUCxXQUFXLEdBQzNDUSxPQUFPLENBQUMscUVBQXFFLElBQzdFQSxPQUFPLENBQUMsTUFBTSxJQUFJLG9CQUFvQjthQUN0Q1AsSUFBSSxHQUNKUSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSx5Q0FBeUM7WUFDM0QsSUFBSUgsV0FBVzNELE1BQU0sR0FBRyxHQUFHeUQsTUFBTXBCLEdBQUcsQ0FBQ3NCO1FBQ3ZDO0lBQ0Y7SUFDQSxPQUFPSSxNQUFNQyxJQUFJLENBQUNQO0FBQ3BCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFudHJ5aXEvLi9saWIvc2NyYXBlcnMvaW5kZXgudHM/MzNhMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdyZWRpcyc7XG5pbXBvcnQgeyBQcm9kdWN0LCBTY3JhcGVSZXN1bHQgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IHNjcmFwZVBpY2tuUGF5IH0gZnJvbSAnLi9waWNrbnBheSc7XG5pbXBvcnQgeyBzY3JhcGVTaG9wcml0ZSB9IGZyb20gJy4vc2hvcHJpdGUnO1xuXG5jb25zdCBDQUNIRV9UVExfU0VDT05EUyA9IDYwICogNjAgKiA2OyAvLyA2IGhvdXJzXG5cbmxldCByZWRpc0NsaWVudDogUmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlQ2xpZW50PiB8IG51bGwgPSBudWxsO1xuXG5hc3luYyBmdW5jdGlvbiBnZXRSZWRpcygpIHtcbiAgaWYgKCFyZWRpc0NsaWVudCkge1xuICAgIHRyeSB7XG4gICAgICByZWRpc0NsaWVudCA9IGNyZWF0ZUNsaWVudCh7IHVybDogcHJvY2Vzcy5lbnYuUkVESVNfVVJMIHx8ICdyZWRpczovL2xvY2FsaG9zdDo2Mzc5JyB9KTtcbiAgICAgIGF3YWl0IHJlZGlzQ2xpZW50LmNvbm5lY3QoKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJlZGlzQ2xpZW50ID0gbnVsbDsgLy8gUmVkaXMgb3B0aW9uYWwg4oCUIGRlZ3JhZGUgZ3JhY2VmdWxseVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVkaXNDbGllbnQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldENhY2hlZChrZXk6IHN0cmluZyk6IFByb21pc2U8UHJvZHVjdFtdIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgZ2V0UmVkaXMoKTtcbiAgICBpZiAoIXJlZGlzKSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCByZWRpcy5nZXQoa2V5KTtcbiAgICByZXR1cm4gY2FjaGVkID8gSlNPTi5wYXJzZShjYWNoZWQpIDogbnVsbDtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gc2V0Q2FjaGUoa2V5OiBzdHJpbmcsIGRhdGE6IFByb2R1Y3RbXSk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgZ2V0UmVkaXMoKTtcbiAgICBpZiAoIXJlZGlzKSByZXR1cm47XG4gICAgYXdhaXQgcmVkaXMuc2V0RXgoa2V5LCBDQUNIRV9UVExfU0VDT05EUywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICB9IGNhdGNoIHtcbiAgICAvLyBDYWNoZSB3cml0ZSBmYWlsdXJlIGlzIG5vbi1mYXRhbFxuICB9XG59XG5cbi8qKlxuICogU2NyYXBlcyBhbGwgY29uZmlndXJlZCByZXRhaWxlcnMgaW4gcGFyYWxsZWwgZm9yIGEgZ2l2ZW4gaW5ncmVkaWVudCBxdWVyeS5cbiAqIFJlc3VsdHMgYXJlIGNhY2hlZCBwZXIgcXVlcnkgdG8gYXZvaWQgaGFtbWVyaW5nIHJldGFpbGVyIHNpdGVzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2NyYXBlQWxsUmV0YWlsZXJzKGluZ3JlZGllbnRzOiBzdHJpbmdbXSk6IFByb21pc2U8UHJvZHVjdFtdPiB7XG4gIGNvbnN0IGFsbFByb2R1Y3RzOiBQcm9kdWN0W10gPSBbXTtcbiAgY29uc3QgdG90YWxUYXNrcyA9IGluZ3JlZGllbnRzLmxlbmd0aCAqIDI7IC8vIDIgc3RvcmVzIHBlciBpbmdyZWRpZW50XG4gIGxldCBjb21wbGV0ZWRUYXNrcyA9IDA7XG5cbiAgY29uc29sZS5sb2coJ1xcbuKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlycpO1xuICBjb25zb2xlLmxvZygn4pWRICAgICAgICAgICAgICDwn5uSIFBBTlRSWUlRIFBSSUNFIFNDUkFQRVIgICAgICAgICAgICAgICAgICAgICDilZEnKTtcbiAgY29uc29sZS5sb2coJ+KVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVnScpO1xuICBjb25zb2xlLmxvZyhgICDwn5OLIEluZ3JlZGllbnRzIHRvIHNlYXJjaDogJHtpbmdyZWRpZW50cy5sZW5ndGh9YCk7XG4gIGNvbnNvbGUubG9nKGAgIPCfj6ogU3RvcmVzOiBQaWNrIG4gUGF5LCBTaG9wcml0ZWApO1xuICBjb25zb2xlLmxvZyhgICDwn5OKIFRvdGFsIHNjcmFwZSB0YXNrczogJHt0b3RhbFRhc2tzfWApO1xuICBjb25zb2xlLmxvZyhgICDij7EgIFN0YXJ0ZWQgYXQ6ICR7bmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKX1cXG5gKTtcblxuICAvLyBSdW4gYWxsIHF1ZXJpZXMgaW4gcGFyYWxsZWwgYWNyb3NzIGFsbCBzdG9yZXMgKHdpdGggaGFyZCB0aW1lb3V0IHBlciB0YXNrKVxuICBjb25zdCBUQVNLX1RJTUVPVVRfTVMgPSA3MDAwOyAvLyA3IHNlY29uZCBoYXJkIGxpbWl0IHBlciBzY3JhcGVcblxuICBjb25zdCB3aXRoVGltZW91dCA9IDxUPihwcm9taXNlOiBQcm9taXNlPFQ+LCBsYWJlbDogc3RyaW5nKTogUHJvbWlzZTxUPiA9PlxuICAgIFByb21pc2UucmFjZShbXG4gICAgICBwcm9taXNlLFxuICAgICAgbmV3IFByb21pc2U8VD4oKF8sIHJlamVjdCkgPT5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKGDij7AgVGltZW91dDogJHtsYWJlbH0gdG9vayBsb25nZXIgdGhhbiAke1RBU0tfVElNRU9VVF9NUyAvIDEwMDB9c2ApKSwgVEFTS19USU1FT1VUX01TKVxuICAgICAgKSxcbiAgICBdKTtcblxuICBjb25zdCB0YXNrcyA9IGluZ3JlZGllbnRzLmZsYXRNYXAoKGluZ3JlZGllbnQpID0+IFtcbiAgICB3aXRoVGltZW91dChcbiAgICAgIHNjcmFwZVdpdGhDYWNoZShpbmdyZWRpZW50LCAncGlja25wYXknLCBzY3JhcGVQaWNrblBheSksXG4gICAgICBgUGljayBuIFBheSDihpIgXCIke2luZ3JlZGllbnR9XCJgXG4gICAgKS50aGVuKChwcm9kdWN0cykgPT4ge1xuICAgICAgY29tcGxldGVkVGFza3MrKztcbiAgICAgIGNvbnN0IGJhciA9IHByb2dyZXNzQmFyKGNvbXBsZXRlZFRhc2tzLCB0b3RhbFRhc2tzKTtcbiAgICAgIGNvbnN0IHN0YXR1cyA9IHByb2R1Y3RzLmxlbmd0aCA+IDAgPyBg4pyFICR7cHJvZHVjdHMubGVuZ3RofSBwcm9kdWN0c2AgOiAn4pqg77iPICAwIHByb2R1Y3RzICh1c2luZyBmYWxsYmFjayknO1xuICAgICAgY29uc29sZS5sb2coYCAgJHtiYXJ9IFske2NvbXBsZXRlZFRhc2tzfS8ke3RvdGFsVGFza3N9XSBQaWNrIG4gUGF5IOKGkiBcIiR7aW5ncmVkaWVudH1cIiDihpIgJHtzdGF0dXN9YCk7XG4gICAgICByZXR1cm4gcHJvZHVjdHM7XG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29tcGxldGVkVGFza3MrKztcbiAgICAgIGNvbnN0IGJhciA9IHByb2dyZXNzQmFyKGNvbXBsZXRlZFRhc2tzLCB0b3RhbFRhc2tzKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICR7YmFyfSBbJHtjb21wbGV0ZWRUYXNrc30vJHt0b3RhbFRhc2tzfV0gUGljayBuIFBheSDihpIgXCIke2luZ3JlZGllbnR9XCIg4oaSIOKPsCBUaW1lZCBvdXQsIHNraXBwaW5nYCk7XG4gICAgICByZXR1cm4gW10gYXMgUHJvZHVjdFtdO1xuICAgIH0pLFxuICAgIHdpdGhUaW1lb3V0KFxuICAgICAgc2NyYXBlV2l0aENhY2hlKGluZ3JlZGllbnQsICdzaG9wcml0ZScsIHNjcmFwZVNob3ByaXRlKSxcbiAgICAgIGBTaG9wcml0ZSDihpIgXCIke2luZ3JlZGllbnR9XCJgXG4gICAgKS50aGVuKChwcm9kdWN0cykgPT4ge1xuICAgICAgY29tcGxldGVkVGFza3MrKztcbiAgICAgIGNvbnN0IGJhciA9IHByb2dyZXNzQmFyKGNvbXBsZXRlZFRhc2tzLCB0b3RhbFRhc2tzKTtcbiAgICAgIGNvbnN0IHN0YXR1cyA9IHByb2R1Y3RzLmxlbmd0aCA+IDAgPyBg4pyFICR7cHJvZHVjdHMubGVuZ3RofSBwcm9kdWN0c2AgOiAn4pqg77iPICAwIHByb2R1Y3RzICh1c2luZyBmYWxsYmFjayknO1xuICAgICAgY29uc29sZS5sb2coYCAgJHtiYXJ9IFske2NvbXBsZXRlZFRhc2tzfS8ke3RvdGFsVGFza3N9XSBTaG9wcml0ZSAgIOKGkiBcIiR7aW5ncmVkaWVudH1cIiDihpIgJHtzdGF0dXN9YCk7XG4gICAgICByZXR1cm4gcHJvZHVjdHM7XG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29tcGxldGVkVGFza3MrKztcbiAgICAgIGNvbnN0IGJhciA9IHByb2dyZXNzQmFyKGNvbXBsZXRlZFRhc2tzLCB0b3RhbFRhc2tzKTtcbiAgICAgIGNvbnNvbGUubG9nKGAgICR7YmFyfSBbJHtjb21wbGV0ZWRUYXNrc30vJHt0b3RhbFRhc2tzfV0gU2hvcHJpdGUgICDihpIgXCIke2luZ3JlZGllbnR9XCIg4oaSIOKPsCBUaW1lZCBvdXQsIHNraXBwaW5nYCk7XG4gICAgICByZXR1cm4gW10gYXMgUHJvZHVjdFtdO1xuICAgIH0pLFxuICBdKTtcblxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwodGFza3MpO1xuXG4gIGZvciAoY29uc3QgcHJvZHVjdHMgb2YgcmVzdWx0cykge1xuICAgIGFsbFByb2R1Y3RzLnB1c2goLi4ucHJvZHVjdHMpO1xuICB9XG5cbiAgLy8gRGVkdXBsaWNhdGUgYnkgaWRcbiAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBjb25zdCBkZWR1cGVkID0gYWxsUHJvZHVjdHMuZmlsdGVyKChwKSA9PiB7XG4gICAgaWYgKHNlZW4uaGFzKHAuaWQpKSByZXR1cm4gZmFsc2U7XG4gICAgc2Vlbi5hZGQocC5pZCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xuXG4gIGNvbnNvbGUubG9nKCdcXG4gIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpO1xuICBjb25zb2xlLmxvZyhgICDwn5OmIFRvdGFsIHByb2R1Y3RzIGZvdW5kOiAke2FsbFByb2R1Y3RzLmxlbmd0aH1gKTtcbiAgY29uc29sZS5sb2coYCAg8J+UhCBBZnRlciBkZWR1cGxpY2F0aW9uOiAke2RlZHVwZWQubGVuZ3RofWApO1xuICBjb25zb2xlLmxvZyhgICDinIUgQ29tcGxldGVkOiAke2NvbXBsZXRlZFRhc2tzfS8ke3RvdGFsVGFza3N9IHRhc2tzYCk7XG4gIGNvbnNvbGUubG9nKGAgIOKPsSAgQ29tcGxldGVkIGF0OiAke25ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCl9YCk7XG4gIGNvbnNvbGUubG9nKCcgIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxcbicpO1xuXG4gIHJldHVybiBkZWR1cGVkO1xufVxuXG5mdW5jdGlvbiBwcm9ncmVzc0JhcihjdXJyZW50OiBudW1iZXIsIHRvdGFsOiBudW1iZXIpOiBzdHJpbmcge1xuICBjb25zdCB3aWR0aCA9IDIwO1xuICBjb25zdCBmaWxsZWQgPSBNYXRoLnJvdW5kKChjdXJyZW50IC8gdG90YWwpICogd2lkdGgpO1xuICBjb25zdCBlbXB0eSA9IHdpZHRoIC0gZmlsbGVkO1xuICBjb25zdCBwY3QgPSBNYXRoLnJvdW5kKChjdXJyZW50IC8gdG90YWwpICogMTAwKTtcbiAgcmV0dXJuIGBbJHsn4paIJy5yZXBlYXQoZmlsbGVkKX0keyfilpEnLnJlcGVhdChlbXB0eSl9XSAke3BjdC50b1N0cmluZygpLnBhZFN0YXJ0KDMpfSVgO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzY3JhcGVXaXRoQ2FjaGUoXG4gIHF1ZXJ5OiBzdHJpbmcsXG4gIHN0b3JlOiBzdHJpbmcsXG4gIHNjcmFwZXI6IChxOiBzdHJpbmcpID0+IFByb21pc2U8UHJvZHVjdFtdPlxuKTogUHJvbWlzZTxQcm9kdWN0W10+IHtcbiAgY29uc3QgY2FjaGVLZXkgPSBgcGFudHJ5aXE6c2NyYXBlOiR7c3RvcmV9OiR7cXVlcnkudG9Mb3dlckNhc2UoKS50cmltKCl9YDtcblxuICBjb25zdCBjYWNoZWQgPSBhd2FpdCBnZXRDYWNoZWQoY2FjaGVLZXkpO1xuICBpZiAoY2FjaGVkKSB7XG4gICAgY29uc29sZS5sb2coYCAg8J+SviBDYWNoZSBoaXQ6ICR7c3RvcmV9IOKGkiBcIiR7cXVlcnl9XCIgKCR7Y2FjaGVkLmxlbmd0aH0gcHJvZHVjdHMpYCk7XG4gICAgcmV0dXJuIGNhY2hlZDtcbiAgfVxuXG4gIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgc2NyYXBlcihxdWVyeSk7XG4gIGF3YWl0IHNldENhY2hlKGNhY2hlS2V5LCBwcm9kdWN0cyk7XG4gIHJldHVybiBwcm9kdWN0cztcbn1cblxuLyoqXG4gKiBFeHRyYWN0cyB1bmlxdWUgaW5ncmVkaWVudCBzZWFyY2ggdGVybXMgZnJvbSBtZWFsIHByb2ZpbGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBidWlsZFNlYXJjaFRlcm1zKG1lYWxzOiB7IGluZ3JlZGllbnRzOiB7IG5hbWU6IHN0cmluZyB9W10gfVtdKTogc3RyaW5nW10ge1xuICBjb25zdCB0ZXJtcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBmb3IgKGNvbnN0IG1lYWwgb2YgbWVhbHMpIHtcbiAgICBmb3IgKGNvbnN0IGluZ3JlZGllbnQgb2YgbWVhbC5pbmdyZWRpZW50cykge1xuICAgICAgLy8gTm9ybWFsaXplOiBcImNoaWNrZW4gYnJlYXN0XCIg4oaSIFwiY2hpY2tlblwiLCBcImJyb3duIG9uaW9uc1wiIOKGkiBcIm9uaW9uXCJcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBpbmdyZWRpZW50Lm5hbWUudG9Mb3dlckNhc2UoKVxuICAgICAgICAucmVwbGFjZSgvXFxiKGZyZXNofGZyb3plbnxkcmllZHxjaG9wcGVkfGRpY2VkfHNsaWNlZHxsYXJnZXxzbWFsbHxtZWRpdW0pXFxiL2csICcnKVxuICAgICAgICAucmVwbGFjZSgvcyQvLCAnJykgLy8gcm91Z2ggc2luZ3VsYXJpemVcbiAgICAgICAgLnRyaW0oKVxuICAgICAgICAuc3BsaXQoJyAnKVswXTsgLy8gdGFrZSBmaXJzdCB3b3JkIGFzIHByaW1hcnkgc2VhcmNoIHRlcm1cbiAgICAgIGlmIChub3JtYWxpemVkLmxlbmd0aCA+IDIpIHRlcm1zLmFkZChub3JtYWxpemVkKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIEFycmF5LmZyb20odGVybXMpO1xufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInNjcmFwZVBpY2tuUGF5Iiwic2NyYXBlU2hvcHJpdGUiLCJDQUNIRV9UVExfU0VDT05EUyIsInJlZGlzQ2xpZW50IiwiZ2V0UmVkaXMiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfVVJMIiwiY29ubmVjdCIsImdldENhY2hlZCIsImtleSIsInJlZGlzIiwiY2FjaGVkIiwiZ2V0IiwiSlNPTiIsInBhcnNlIiwic2V0Q2FjaGUiLCJkYXRhIiwic2V0RXgiLCJzdHJpbmdpZnkiLCJzY3JhcGVBbGxSZXRhaWxlcnMiLCJpbmdyZWRpZW50cyIsImFsbFByb2R1Y3RzIiwidG90YWxUYXNrcyIsImxlbmd0aCIsImNvbXBsZXRlZFRhc2tzIiwiY29uc29sZSIsImxvZyIsIkRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJUQVNLX1RJTUVPVVRfTVMiLCJ3aXRoVGltZW91dCIsInByb21pc2UiLCJsYWJlbCIsIlByb21pc2UiLCJyYWNlIiwiXyIsInJlamVjdCIsInNldFRpbWVvdXQiLCJFcnJvciIsInRhc2tzIiwiZmxhdE1hcCIsImluZ3JlZGllbnQiLCJzY3JhcGVXaXRoQ2FjaGUiLCJ0aGVuIiwicHJvZHVjdHMiLCJiYXIiLCJwcm9ncmVzc0JhciIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwicmVzdWx0cyIsImFsbCIsInB1c2giLCJzZWVuIiwiU2V0IiwiZGVkdXBlZCIsImZpbHRlciIsInAiLCJoYXMiLCJpZCIsImFkZCIsImN1cnJlbnQiLCJ0b3RhbCIsIndpZHRoIiwiZmlsbGVkIiwiTWF0aCIsInJvdW5kIiwiZW1wdHkiLCJwY3QiLCJyZXBlYXQiLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwicXVlcnkiLCJzdG9yZSIsInNjcmFwZXIiLCJjYWNoZUtleSIsInRvTG93ZXJDYXNlIiwidHJpbSIsImJ1aWxkU2VhcmNoVGVybXMiLCJtZWFscyIsInRlcm1zIiwibWVhbCIsIm5vcm1hbGl6ZWQiLCJuYW1lIiwicmVwbGFjZSIsInNwbGl0IiwiQXJyYXkiLCJmcm9tIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/scrapers/index.ts\n");

/***/ }),

/***/ "(rsc)/./lib/scrapers/picknpay.ts":
/*!**********************************!*\
  !*** ./lib/scrapers/picknpay.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   scrapePicknPay: () => (/* binding */ scrapePicknPay)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cheerio */ \"cheerio\");\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(cheerio__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/utils */ \"(rsc)/./lib/utils.ts\");\n\n\n\nconst BASE_URL = \"https://www.picknpay.co.za\";\nconst SEARCH_URL = `${BASE_URL}/search?q=`;\nconst HEADERS = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\",\n    Accept: \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\",\n    \"Accept-Language\": \"en-ZA,en;q=0.9\",\n    \"Accept-Encoding\": \"gzip, deflate, br\",\n    Connection: \"keep-alive\"\n};\nasync function scrapePicknPay(query) {\n    try {\n        const url = `${SEARCH_URL}${encodeURIComponent(query)}`;\n        console.log(`     üåê PnP: Fetching \"${query}\"...`);\n        const response = await axios__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get(url, {\n            headers: HEADERS,\n            timeout: 5000\n        });\n        console.log(`     üåê PnP: Response ${response.status} for \"${query}\"`);\n        const $ = cheerio__WEBPACK_IMPORTED_MODULE_0__.load(response.data);\n        const products = [];\n        // PnP uses product card structure\n        $('[data-testid=\"product-card\"], .product-card, [class*=\"ProductCard\"]').each((_, el)=>{\n            try {\n                const name = $(el).find('[class*=\"name\"], [class*=\"title\"], h3').first().text().trim();\n                const priceText = $(el).find('[class*=\"price\"], [class*=\"Price\"]').first().text().trim();\n                const price = parseFloat(priceText.replace(/[^0-9.]/g, \"\"));\n                const href = $(el).find(\"a\").attr(\"href\") || \"\";\n                const image = $(el).find(\"img\").attr(\"src\") || \"\";\n                if (!name || isNaN(price) || price <= 0) return;\n                // Extract weight from product name e.g. \"Chicken 1kg\" ‚Üí 1000g\n                const weightMatch = name.match(/(\\d+(?:\\.\\d+)?)\\s*(kg|g|ml|l)/i);\n                const weight = weightMatch ? parseWeight(parseFloat(weightMatch[1]), weightMatch[2]) : 1000;\n                products.push({\n                    id: (0,_lib_utils__WEBPACK_IMPORTED_MODULE_1__.generateId)(\"pnp\", name),\n                    name,\n                    brand: extractBrand(name),\n                    price,\n                    weight,\n                    unit_price: price / weight * 100,\n                    store: \"picknpay\",\n                    category: inferCategory(name),\n                    url: href.startsWith(\"http\") ? href : `${BASE_URL}${href}`,\n                    image_url: image,\n                    in_stock: true,\n                    scraped_at: new Date()\n                });\n            } catch  {\n            // Skip malformed product\n            }\n        });\n        // If live scraping yields results, great. Otherwise fall back to mock data.\n        if (products.length > 0) {\n            console.log(`     ‚úÖ PnP: Scraped ${products.length} live products for \"${query}\"`);\n            return products;\n        }\n        console.log(`     üì¶ PnP: No live results for \"${query}\", using mock data`);\n        return getMockPicknPayProducts(query);\n    } catch (err) {\n        console.log(`     ‚ö†Ô∏è  PnP: Scrape failed for \"${query}\" ‚Äî using mock data`);\n        return getMockPicknPayProducts(query);\n    }\n}\nfunction parseWeight(value, unit) {\n    const u = unit.toLowerCase();\n    if (u === \"kg\") return value * 1000;\n    if (u === \"l\") return value * 1000;\n    if (u === \"g\" || u === \"ml\") return value;\n    return 1000;\n}\nfunction extractBrand(name) {\n    const brands = [\n        \"Clover\",\n        \"Parmalat\",\n        \"Woolworths\",\n        \"Sasko\",\n        \"Albany\",\n        \"Spar\",\n        \"Pick n Pay\",\n        \"PnP\",\n        \"Knorr\",\n        \"Ina Paarman\",\n        \"Koo\",\n        \"All Gold\",\n        \"Rhodes\",\n        \"Bull Brand\",\n        \"Checkers\",\n        \"Shoprite\",\n        \"Fatti's & Moni's\"\n    ];\n    for (const brand of brands){\n        if (name.toLowerCase().includes(brand.toLowerCase())) return brand;\n    }\n    return name.split(\" \")[0];\n}\nfunction inferCategory(name) {\n    const lower = name.toLowerCase();\n    if (/chicken|beef|lamb|pork|mince|fish|tuna|sardine/.test(lower)) return \"protein\";\n    if (/milk|cheese|yogurt|butter|cream|egg/.test(lower)) return \"dairy\";\n    if (/bread|flour|rice|pasta|pap|maize|oats/.test(lower)) return \"grain\";\n    if (/tomato|onion|potato|carrot|cabbage|spinach|pepper|vegetable/.test(lower)) return \"vegetable\";\n    if (/apple|banana|orange|fruit/.test(lower)) return \"fruit\";\n    if (/oil|salt|pepper|spice|sauce|ketchup|mayonnaise/.test(lower)) return \"condiment\";\n    if (/tea|coffee|juice|drink|cola|water/.test(lower)) return \"beverage\";\n    return \"other\";\n}\nfunction getMockPicknPayProducts(query) {\n    const q = query.toLowerCase();\n    const now = new Date();\n    const catalog = {\n        chicken: [\n            {\n                id: \"pnp-chicken-001\",\n                name: \"Country Fair Frozen Chicken Portions 1kg\",\n                brand: \"Country Fair\",\n                price: 54.99,\n                weight: 1000,\n                unit_price: 5.499,\n                store: \"picknpay\",\n                category: \"protein\",\n                url: \"https://www.picknpay.co.za/chicken\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-chicken-002\",\n                name: \"PnP Chicken Breast Fillets 600g\",\n                brand: \"Pick n Pay\",\n                price: 69.99,\n                weight: 600,\n                unit_price: 11.665,\n                store: \"picknpay\",\n                category: \"protein\",\n                url: \"https://www.picknpay.co.za/chicken-breast\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-chicken-003\",\n                name: \"Rainbow Frozen Whole Chicken 1.5kg\",\n                brand: \"Rainbow\",\n                price: 79.99,\n                weight: 1500,\n                unit_price: 5.333,\n                store: \"picknpay\",\n                category: \"protein\",\n                url: \"https://www.picknpay.co.za/whole-chicken\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        maize: [\n            {\n                id: \"pnp-maize-001\",\n                name: \"White Star Super Maize Meal 5kg\",\n                brand: \"White Star\",\n                price: 69.99,\n                weight: 5000,\n                unit_price: 1.4,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/maize\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-maize-002\",\n                name: \"Iwisa No. 1 Super Maize Meal 5kg\",\n                brand: \"Iwisa\",\n                price: 64.99,\n                weight: 5000,\n                unit_price: 1.3,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/iwisa\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        tomato: [\n            {\n                id: \"pnp-tomato-001\",\n                name: \"All Gold Tomato Paste 400g\",\n                brand: \"All Gold\",\n                price: 16.99,\n                weight: 400,\n                unit_price: 4.248,\n                store: \"picknpay\",\n                category: \"vegetable\",\n                url: \"https://www.picknpay.co.za/tomato-paste\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-tomato-002\",\n                name: \"Rhodes Tomato Puree 410g\",\n                brand: \"Rhodes\",\n                price: 14.99,\n                weight: 410,\n                unit_price: 3.656,\n                store: \"picknpay\",\n                category: \"vegetable\",\n                url: \"https://www.picknpay.co.za/tomato-puree\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-tomato-003\",\n                name: \"Fresh Tomatoes 1kg\",\n                brand: \"Fresh Produce\",\n                price: 24.99,\n                weight: 1000,\n                unit_price: 2.499,\n                store: \"picknpay\",\n                category: \"vegetable\",\n                url: \"https://www.picknpay.co.za/fresh-tomatoes\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        onion: [\n            {\n                id: \"pnp-onion-001\",\n                name: \"Brown Onions 1.5kg bag\",\n                brand: \"Fresh Produce\",\n                price: 18.99,\n                weight: 1500,\n                unit_price: 1.266,\n                store: \"picknpay\",\n                category: \"vegetable\",\n                url: \"https://www.picknpay.co.za/onions\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        oil: [\n            {\n                id: \"pnp-oil-001\",\n                name: \"Canola Cooking Oil 2L\",\n                brand: \"Sunshine D\",\n                price: 49.99,\n                weight: 2000,\n                unit_price: 2.5,\n                store: \"picknpay\",\n                category: \"condiment\",\n                url: \"https://www.picknpay.co.za/cooking-oil\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-oil-002\",\n                name: \"Sunflower Oil 750ml\",\n                brand: \"Oryx\",\n                price: 29.99,\n                weight: 750,\n                unit_price: 4.0,\n                store: \"picknpay\",\n                category: \"condiment\",\n                url: \"https://www.picknpay.co.za/sunflower-oil\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        rice: [\n            {\n                id: \"pnp-rice-001\",\n                name: \"Tastic Rice 2kg\",\n                brand: \"Tastic\",\n                price: 39.99,\n                weight: 2000,\n                unit_price: 2.0,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/rice\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-rice-002\",\n                name: \"PnP Long Grain White Rice 5kg\",\n                brand: \"Pick n Pay\",\n                price: 79.99,\n                weight: 5000,\n                unit_price: 1.6,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/rice-5kg\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        bread: [\n            {\n                id: \"pnp-bread-001\",\n                name: \"Albany Superior White Bread 700g\",\n                brand: \"Albany\",\n                price: 18.99,\n                weight: 700,\n                unit_price: 2.713,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/bread\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-bread-002\",\n                name: \"Sasko White Bread 700g\",\n                brand: \"Sasko\",\n                price: 17.99,\n                weight: 700,\n                unit_price: 2.57,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/sasko-bread\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        egg: [\n            {\n                id: \"pnp-eggs-001\",\n                name: \"Nulaid Large Eggs 6 pack\",\n                brand: \"Nulaid\",\n                price: 27.99,\n                weight: 360,\n                unit_price: 7.775,\n                store: \"picknpay\",\n                category: \"dairy\",\n                url: \"https://www.picknpay.co.za/eggs\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-eggs-002\",\n                name: \"PnP Free Range Eggs 12 pack\",\n                brand: \"Pick n Pay\",\n                price: 59.99,\n                weight: 720,\n                unit_price: 8.332,\n                store: \"picknpay\",\n                category: \"dairy\",\n                url: \"https://www.picknpay.co.za/free-range-eggs\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        milk: [\n            {\n                id: \"pnp-milk-001\",\n                name: \"Clover Full Cream Milk 1L\",\n                brand: \"Clover\",\n                price: 21.99,\n                weight: 1000,\n                unit_price: 2.199,\n                store: \"picknpay\",\n                category: \"dairy\",\n                url: \"https://www.picknpay.co.za/milk\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"pnp-milk-002\",\n                name: \"Parmalat Full Cream Milk 2L\",\n                brand: \"Parmalat\",\n                price: 38.99,\n                weight: 2000,\n                unit_price: 1.95,\n                store: \"picknpay\",\n                category: \"dairy\",\n                url: \"https://www.picknpay.co.za/parmalat-milk\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        pasta: [\n            {\n                id: \"pnp-pasta-001\",\n                name: \"Fatti's & Moni's Spaghetti 500g\",\n                brand: \"Fatti's & Moni's\",\n                price: 19.99,\n                weight: 500,\n                unit_price: 4.0,\n                store: \"picknpay\",\n                category: \"grain\",\n                url: \"https://www.picknpay.co.za/pasta\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ]\n    };\n    // Find matching products\n    const results = [];\n    for (const [key, products] of Object.entries(catalog)){\n        if (q.includes(key) || key.includes(q)) {\n            results.push(...products);\n        }\n    }\n    // If no direct match, return a generic assortment\n    if (results.length === 0) {\n        return Object.values(catalog).flat().slice(0, 5);\n    }\n    return results;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsR0FBRztJQUNoRDtJQUVBLE9BQU9OO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYW50cnlpcS8uL2xpYi9zY3JhcGVycy9waWNrbnBheS50cz9lMzg4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgKiBhcyBjaGVlcmlvIGZyb20gJ2NoZWVyaW8nO1xuaW1wb3J0IHsgUHJvZHVjdCB9IGZyb20gJ0AvdHlwZXMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVJZCB9IGZyb20gJ0AvbGliL3V0aWxzJztcblxuY29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEnO1xuY29uc3QgU0VBUkNIX1VSTCA9IGAke0JBU0VfVVJMfS9zZWFyY2g/cT1gO1xuXG5jb25zdCBIRUFERVJTID0ge1xuICAnVXNlci1BZ2VudCc6XG4gICAgJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjQuMC4wLjAgU2FmYXJpLzUzNy4zNicsXG4gIEFjY2VwdDogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOCcsXG4gICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tWkEsZW47cT0wLjknLFxuICAnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUsIGJyJyxcbiAgQ29ubmVjdGlvbjogJ2tlZXAtYWxpdmUnLFxufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNjcmFwZVBpY2tuUGF5KHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPFByb2R1Y3RbXT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVybCA9IGAke1NFQVJDSF9VUkx9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfWA7XG4gICAgY29uc29sZS5sb2coYCAgICAg8J+MkCBQblA6IEZldGNoaW5nIFwiJHtxdWVyeX1cIi4uLmApO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHVybCwge1xuICAgICAgaGVhZGVyczogSEVBREVSUyxcbiAgICAgIHRpbWVvdXQ6IDUwMDAsXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coYCAgICAg8J+MkCBQblA6IFJlc3BvbnNlICR7cmVzcG9uc2Uuc3RhdHVzfSBmb3IgXCIke3F1ZXJ5fVwiYCk7XG5cbiAgICBjb25zdCAkID0gY2hlZXJpby5sb2FkKHJlc3BvbnNlLmRhdGEpO1xuICAgIGNvbnN0IHByb2R1Y3RzOiBQcm9kdWN0W10gPSBbXTtcblxuICAgIC8vIFBuUCB1c2VzIHByb2R1Y3QgY2FyZCBzdHJ1Y3R1cmVcbiAgICAkKCdbZGF0YS10ZXN0aWQ9XCJwcm9kdWN0LWNhcmRcIl0sIC5wcm9kdWN0LWNhcmQsIFtjbGFzcyo9XCJQcm9kdWN0Q2FyZFwiXScpLmVhY2goKF8sIGVsKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBuYW1lID0gJChlbCkuZmluZCgnW2NsYXNzKj1cIm5hbWVcIl0sIFtjbGFzcyo9XCJ0aXRsZVwiXSwgaDMnKS5maXJzdCgpLnRleHQoKS50cmltKCk7XG4gICAgICAgIGNvbnN0IHByaWNlVGV4dCA9ICQoZWwpLmZpbmQoJ1tjbGFzcyo9XCJwcmljZVwiXSwgW2NsYXNzKj1cIlByaWNlXCJdJykuZmlyc3QoKS50ZXh0KCkudHJpbSgpO1xuICAgICAgICBjb25zdCBwcmljZSA9IHBhcnNlRmxvYXQocHJpY2VUZXh0LnJlcGxhY2UoL1teMC05Ll0vZywgJycpKTtcbiAgICAgICAgY29uc3QgaHJlZiA9ICQoZWwpLmZpbmQoJ2EnKS5hdHRyKCdocmVmJykgfHwgJyc7XG4gICAgICAgIGNvbnN0IGltYWdlID0gJChlbCkuZmluZCgnaW1nJykuYXR0cignc3JjJykgfHwgJyc7XG5cbiAgICAgICAgaWYgKCFuYW1lIHx8IGlzTmFOKHByaWNlKSB8fCBwcmljZSA8PSAwKSByZXR1cm47XG5cbiAgICAgICAgLy8gRXh0cmFjdCB3ZWlnaHQgZnJvbSBwcm9kdWN0IG5hbWUgZS5nLiBcIkNoaWNrZW4gMWtnXCIg4oaSIDEwMDBnXG4gICAgICAgIGNvbnN0IHdlaWdodE1hdGNoID0gbmFtZS5tYXRjaCgvKFxcZCsoPzpcXC5cXGQrKT8pXFxzKihrZ3xnfG1sfGwpL2kpO1xuICAgICAgICBjb25zdCB3ZWlnaHQgPSB3ZWlnaHRNYXRjaFxuICAgICAgICAgID8gcGFyc2VXZWlnaHQocGFyc2VGbG9hdCh3ZWlnaHRNYXRjaFsxXSksIHdlaWdodE1hdGNoWzJdKVxuICAgICAgICAgIDogMTAwMDtcblxuICAgICAgICBwcm9kdWN0cy5wdXNoKHtcbiAgICAgICAgICBpZDogZ2VuZXJhdGVJZCgncG5wJywgbmFtZSksXG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBicmFuZDogZXh0cmFjdEJyYW5kKG5hbWUpLFxuICAgICAgICAgIHByaWNlLFxuICAgICAgICAgIHdlaWdodCxcbiAgICAgICAgICB1bml0X3ByaWNlOiAocHJpY2UgLyB3ZWlnaHQpICogMTAwLFxuICAgICAgICAgIHN0b3JlOiAncGlja25wYXknLFxuICAgICAgICAgIGNhdGVnb3J5OiBpbmZlckNhdGVnb3J5KG5hbWUpLFxuICAgICAgICAgIHVybDogaHJlZi5zdGFydHNXaXRoKCdodHRwJykgPyBocmVmIDogYCR7QkFTRV9VUkx9JHtocmVmfWAsXG4gICAgICAgICAgaW1hZ2VfdXJsOiBpbWFnZSxcbiAgICAgICAgICBpbl9zdG9jazogdHJ1ZSxcbiAgICAgICAgICBzY3JhcGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICAvLyBTa2lwIG1hbGZvcm1lZCBwcm9kdWN0XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBJZiBsaXZlIHNjcmFwaW5nIHlpZWxkcyByZXN1bHRzLCBncmVhdC4gT3RoZXJ3aXNlIGZhbGwgYmFjayB0byBtb2NrIGRhdGEuXG4gICAgaWYgKHByb2R1Y3RzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKGAgICAgIOKchSBQblA6IFNjcmFwZWQgJHtwcm9kdWN0cy5sZW5ndGh9IGxpdmUgcHJvZHVjdHMgZm9yIFwiJHtxdWVyeX1cImApO1xuICAgICAgcmV0dXJuIHByb2R1Y3RzO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhgICAgICDwn5OmIFBuUDogTm8gbGl2ZSByZXN1bHRzIGZvciBcIiR7cXVlcnl9XCIsIHVzaW5nIG1vY2sgZGF0YWApO1xuICAgIHJldHVybiBnZXRNb2NrUGlja25QYXlQcm9kdWN0cyhxdWVyeSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUubG9nKGAgICAgIOKaoO+4jyAgUG5QOiBTY3JhcGUgZmFpbGVkIGZvciBcIiR7cXVlcnl9XCIg4oCUIHVzaW5nIG1vY2sgZGF0YWApO1xuICAgIHJldHVybiBnZXRNb2NrUGlja25QYXlQcm9kdWN0cyhxdWVyeSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcGFyc2VXZWlnaHQodmFsdWU6IG51bWJlciwgdW5pdDogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgdSA9IHVuaXQudG9Mb3dlckNhc2UoKTtcbiAgaWYgKHUgPT09ICdrZycpIHJldHVybiB2YWx1ZSAqIDEwMDA7XG4gIGlmICh1ID09PSAnbCcpIHJldHVybiB2YWx1ZSAqIDEwMDA7XG4gIGlmICh1ID09PSAnZycgfHwgdSA9PT0gJ21sJykgcmV0dXJuIHZhbHVlO1xuICByZXR1cm4gMTAwMDtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdEJyYW5kKG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGJyYW5kcyA9IFtcbiAgICAnQ2xvdmVyJywgJ1Bhcm1hbGF0JywgJ1dvb2x3b3J0aHMnLCAnU2Fza28nLCAnQWxiYW55JywgJ1NwYXInLFxuICAgICdQaWNrIG4gUGF5JywgJ1BuUCcsICdLbm9ycicsICdJbmEgUGFhcm1hbicsICdLb28nLCAnQWxsIEdvbGQnLFxuICAgICdSaG9kZXMnLCAnQnVsbCBCcmFuZCcsICdDaGVja2VycycsICdTaG9wcml0ZScsICdGYXR0aVxcJ3MgJiBNb25pXFwncycsXG4gIF07XG4gIGZvciAoY29uc3QgYnJhbmQgb2YgYnJhbmRzKSB7XG4gICAgaWYgKG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhicmFuZC50b0xvd2VyQ2FzZSgpKSkgcmV0dXJuIGJyYW5kO1xuICB9XG4gIHJldHVybiBuYW1lLnNwbGl0KCcgJylbMF07XG59XG5cbmZ1bmN0aW9uIGluZmVyQ2F0ZWdvcnkobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgbG93ZXIgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGlmICgvY2hpY2tlbnxiZWVmfGxhbWJ8cG9ya3xtaW5jZXxmaXNofHR1bmF8c2FyZGluZS8udGVzdChsb3dlcikpIHJldHVybiAncHJvdGVpbic7XG4gIGlmICgvbWlsa3xjaGVlc2V8eW9ndXJ0fGJ1dHRlcnxjcmVhbXxlZ2cvLnRlc3QobG93ZXIpKSByZXR1cm4gJ2RhaXJ5JztcbiAgaWYgKC9icmVhZHxmbG91cnxyaWNlfHBhc3RhfHBhcHxtYWl6ZXxvYXRzLy50ZXN0KGxvd2VyKSkgcmV0dXJuICdncmFpbic7XG4gIGlmICgvdG9tYXRvfG9uaW9ufHBvdGF0b3xjYXJyb3R8Y2FiYmFnZXxzcGluYWNofHBlcHBlcnx2ZWdldGFibGUvLnRlc3QobG93ZXIpKSByZXR1cm4gJ3ZlZ2V0YWJsZSc7XG4gIGlmICgvYXBwbGV8YmFuYW5hfG9yYW5nZXxmcnVpdC8udGVzdChsb3dlcikpIHJldHVybiAnZnJ1aXQnO1xuICBpZiAoL29pbHxzYWx0fHBlcHBlcnxzcGljZXxzYXVjZXxrZXRjaHVwfG1heW9ubmFpc2UvLnRlc3QobG93ZXIpKSByZXR1cm4gJ2NvbmRpbWVudCc7XG4gIGlmICgvdGVhfGNvZmZlZXxqdWljZXxkcmlua3xjb2xhfHdhdGVyLy50ZXN0KGxvd2VyKSkgcmV0dXJuICdiZXZlcmFnZSc7XG4gIHJldHVybiAnb3RoZXInO1xufVxuXG5mdW5jdGlvbiBnZXRNb2NrUGlja25QYXlQcm9kdWN0cyhxdWVyeTogc3RyaW5nKTogUHJvZHVjdFtdIHtcbiAgY29uc3QgcSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgY29uc3QgY2F0YWxvZzogUmVjb3JkPHN0cmluZywgUHJvZHVjdFtdPiA9IHtcbiAgICBjaGlja2VuOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAncG5wLWNoaWNrZW4tMDAxJywgbmFtZTogJ0NvdW50cnkgRmFpciBGcm96ZW4gQ2hpY2tlbiBQb3J0aW9ucyAxa2cnLCBicmFuZDogJ0NvdW50cnkgRmFpcicsXG4gICAgICAgIHByaWNlOiA1NC45OSwgd2VpZ2h0OiAxMDAwLCB1bml0X3ByaWNlOiA1LjQ5OSwgc3RvcmU6ICdwaWNrbnBheScsIGNhdGVnb3J5OiAncHJvdGVpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL2NoaWNrZW4nLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtY2hpY2tlbi0wMDInLCBuYW1lOiAnUG5QIENoaWNrZW4gQnJlYXN0IEZpbGxldHMgNjAwZycsIGJyYW5kOiAnUGljayBuIFBheScsXG4gICAgICAgIHByaWNlOiA2OS45OSwgd2VpZ2h0OiA2MDAsIHVuaXRfcHJpY2U6IDExLjY2NSwgc3RvcmU6ICdwaWNrbnBheScsIGNhdGVnb3J5OiAncHJvdGVpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL2NoaWNrZW4tYnJlYXN0JywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAncG5wLWNoaWNrZW4tMDAzJywgbmFtZTogJ1JhaW5ib3cgRnJvemVuIFdob2xlIENoaWNrZW4gMS41a2cnLCBicmFuZDogJ1JhaW5ib3cnLFxuICAgICAgICBwcmljZTogNzkuOTksIHdlaWdodDogMTUwMCwgdW5pdF9wcmljZTogNS4zMzMsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ3Byb3RlaW4nLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5waWNrbnBheS5jby56YS93aG9sZS1jaGlja2VuJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBtYWl6ZTogW1xuICAgICAge1xuICAgICAgICBpZDogJ3BucC1tYWl6ZS0wMDEnLCBuYW1lOiAnV2hpdGUgU3RhciBTdXBlciBNYWl6ZSBNZWFsIDVrZycsIGJyYW5kOiAnV2hpdGUgU3RhcicsXG4gICAgICAgIHByaWNlOiA2OS45OSwgd2VpZ2h0OiA1MDAwLCB1bml0X3ByaWNlOiAxLjQsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ2dyYWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEvbWFpemUnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtbWFpemUtMDAyJywgbmFtZTogJ0l3aXNhIE5vLiAxIFN1cGVyIE1haXplIE1lYWwgNWtnJywgYnJhbmQ6ICdJd2lzYScsXG4gICAgICAgIHByaWNlOiA2NC45OSwgd2VpZ2h0OiA1MDAwLCB1bml0X3ByaWNlOiAxLjMsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ2dyYWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEvaXdpc2EnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIHRvbWF0bzogW1xuICAgICAge1xuICAgICAgICBpZDogJ3BucC10b21hdG8tMDAxJywgbmFtZTogJ0FsbCBHb2xkIFRvbWF0byBQYXN0ZSA0MDBnJywgYnJhbmQ6ICdBbGwgR29sZCcsXG4gICAgICAgIHByaWNlOiAxNi45OSwgd2VpZ2h0OiA0MDAsIHVuaXRfcHJpY2U6IDQuMjQ4LCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICd2ZWdldGFibGUnLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5waWNrbnBheS5jby56YS90b21hdG8tcGFzdGUnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtdG9tYXRvLTAwMicsIG5hbWU6ICdSaG9kZXMgVG9tYXRvIFB1cmVlIDQxMGcnLCBicmFuZDogJ1Job2RlcycsXG4gICAgICAgIHByaWNlOiAxNC45OSwgd2VpZ2h0OiA0MTAsIHVuaXRfcHJpY2U6IDMuNjU2LCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICd2ZWdldGFibGUnLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5waWNrbnBheS5jby56YS90b21hdG8tcHVyZWUnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtdG9tYXRvLTAwMycsIG5hbWU6ICdGcmVzaCBUb21hdG9lcyAxa2cnLCBicmFuZDogJ0ZyZXNoIFByb2R1Y2UnLFxuICAgICAgICBwcmljZTogMjQuOTksIHdlaWdodDogMTAwMCwgdW5pdF9wcmljZTogMi40OTksIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ3ZlZ2V0YWJsZScsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL2ZyZXNoLXRvbWF0b2VzJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBvbmlvbjogW1xuICAgICAge1xuICAgICAgICBpZDogJ3BucC1vbmlvbi0wMDEnLCBuYW1lOiAnQnJvd24gT25pb25zIDEuNWtnIGJhZycsIGJyYW5kOiAnRnJlc2ggUHJvZHVjZScsXG4gICAgICAgIHByaWNlOiAxOC45OSwgd2VpZ2h0OiAxNTAwLCB1bml0X3ByaWNlOiAxLjI2Niwgc3RvcmU6ICdwaWNrbnBheScsIGNhdGVnb3J5OiAndmVnZXRhYmxlJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEvb25pb25zJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBvaWw6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtb2lsLTAwMScsIG5hbWU6ICdDYW5vbGEgQ29va2luZyBPaWwgMkwnLCBicmFuZDogJ1N1bnNoaW5lIEQnLFxuICAgICAgICBwcmljZTogNDkuOTksIHdlaWdodDogMjAwMCwgdW5pdF9wcmljZTogMi41LCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICdjb25kaW1lbnQnLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5waWNrbnBheS5jby56YS9jb29raW5nLW9pbCcsIGluX3N0b2NrOiB0cnVlLCBzY3JhcGVkX2F0OiBub3csXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ3BucC1vaWwtMDAyJywgbmFtZTogJ1N1bmZsb3dlciBPaWwgNzUwbWwnLCBicmFuZDogJ09yeXgnLFxuICAgICAgICBwcmljZTogMjkuOTksIHdlaWdodDogNzUwLCB1bml0X3ByaWNlOiA0LjAsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ2NvbmRpbWVudCcsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL3N1bmZsb3dlci1vaWwnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIHJpY2U6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtcmljZS0wMDEnLCBuYW1lOiAnVGFzdGljIFJpY2UgMmtnJywgYnJhbmQ6ICdUYXN0aWMnLFxuICAgICAgICBwcmljZTogMzkuOTksIHdlaWdodDogMjAwMCwgdW5pdF9wcmljZTogMi4wLCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICdncmFpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL3JpY2UnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtcmljZS0wMDInLCBuYW1lOiAnUG5QIExvbmcgR3JhaW4gV2hpdGUgUmljZSA1a2cnLCBicmFuZDogJ1BpY2sgbiBQYXknLFxuICAgICAgICBwcmljZTogNzkuOTksIHdlaWdodDogNTAwMCwgdW5pdF9wcmljZTogMS42LCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICdncmFpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL3JpY2UtNWtnJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBicmVhZDogW1xuICAgICAge1xuICAgICAgICBpZDogJ3BucC1icmVhZC0wMDEnLCBuYW1lOiAnQWxiYW55IFN1cGVyaW9yIFdoaXRlIEJyZWFkIDcwMGcnLCBicmFuZDogJ0FsYmFueScsXG4gICAgICAgIHByaWNlOiAxOC45OSwgd2VpZ2h0OiA3MDAsIHVuaXRfcHJpY2U6IDIuNzEzLCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICdncmFpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL2JyZWFkJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAncG5wLWJyZWFkLTAwMicsIG5hbWU6ICdTYXNrbyBXaGl0ZSBCcmVhZCA3MDBnJywgYnJhbmQ6ICdTYXNrbycsXG4gICAgICAgIHByaWNlOiAxNy45OSwgd2VpZ2h0OiA3MDAsIHVuaXRfcHJpY2U6IDIuNTcsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ2dyYWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEvc2Fza28tYnJlYWQnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIGVnZzogW1xuICAgICAge1xuICAgICAgICBpZDogJ3BucC1lZ2dzLTAwMScsIG5hbWU6ICdOdWxhaWQgTGFyZ2UgRWdncyA2IHBhY2snLCBicmFuZDogJ051bGFpZCcsXG4gICAgICAgIHByaWNlOiAyNy45OSwgd2VpZ2h0OiAzNjAsIHVuaXRfcHJpY2U6IDcuNzc1LCBzdG9yZTogJ3BpY2tucGF5JywgY2F0ZWdvcnk6ICdkYWlyeScsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnBpY2tucGF5LmNvLnphL2VnZ3MnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwbnAtZWdncy0wMDInLCBuYW1lOiAnUG5QIEZyZWUgUmFuZ2UgRWdncyAxMiBwYWNrJywgYnJhbmQ6ICdQaWNrIG4gUGF5JyxcbiAgICAgICAgcHJpY2U6IDU5Ljk5LCB3ZWlnaHQ6IDcyMCwgdW5pdF9wcmljZTogOC4zMzIsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ2RhaXJ5JyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEvZnJlZS1yYW5nZS1lZ2dzJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBtaWxrOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAncG5wLW1pbGstMDAxJywgbmFtZTogJ0Nsb3ZlciBGdWxsIENyZWFtIE1pbGsgMUwnLCBicmFuZDogJ0Nsb3ZlcicsXG4gICAgICAgIHByaWNlOiAyMS45OSwgd2VpZ2h0OiAxMDAwLCB1bml0X3ByaWNlOiAyLjE5OSwgc3RvcmU6ICdwaWNrbnBheScsIGNhdGVnb3J5OiAnZGFpcnknLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5waWNrbnBheS5jby56YS9taWxrJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAncG5wLW1pbGstMDAyJywgbmFtZTogJ1Bhcm1hbGF0IEZ1bGwgQ3JlYW0gTWlsayAyTCcsIGJyYW5kOiAnUGFybWFsYXQnLFxuICAgICAgICBwcmljZTogMzguOTksIHdlaWdodDogMjAwMCwgdW5pdF9wcmljZTogMS45NSwgc3RvcmU6ICdwaWNrbnBheScsIGNhdGVnb3J5OiAnZGFpcnknLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5waWNrbnBheS5jby56YS9wYXJtYWxhdC1taWxrJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBwYXN0YTogW1xuICAgICAge1xuICAgICAgICBpZDogJ3BucC1wYXN0YS0wMDEnLCBuYW1lOiBcIkZhdHRpJ3MgJiBNb25pJ3MgU3BhZ2hldHRpIDUwMGdcIiwgYnJhbmQ6IFwiRmF0dGkncyAmIE1vbmknc1wiLFxuICAgICAgICBwcmljZTogMTkuOTksIHdlaWdodDogNTAwLCB1bml0X3ByaWNlOiA0LjAsIHN0b3JlOiAncGlja25wYXknLCBjYXRlZ29yeTogJ2dyYWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cucGlja25wYXkuY28uemEvcGFzdGEnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICB9O1xuXG4gIC8vIEZpbmQgbWF0Y2hpbmcgcHJvZHVjdHNcbiAgY29uc3QgcmVzdWx0czogUHJvZHVjdFtdID0gW107XG4gIGZvciAoY29uc3QgW2tleSwgcHJvZHVjdHNdIG9mIE9iamVjdC5lbnRyaWVzKGNhdGFsb2cpKSB7XG4gICAgaWYgKHEuaW5jbHVkZXMoa2V5KSB8fCBrZXkuaW5jbHVkZXMocSkpIHtcbiAgICAgIHJlc3VsdHMucHVzaCguLi5wcm9kdWN0cyk7XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgbm8gZGlyZWN0IG1hdGNoLCByZXR1cm4gYSBnZW5lcmljIGFzc29ydG1lbnRcbiAgaWYgKHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoY2F0YWxvZykuZmxhdCgpLnNsaWNlKDAsIDUpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG4iXSwibmFtZXMiOlsiYXhpb3MiLCJjaGVlcmlvIiwiZ2VuZXJhdGVJZCIsIkJBU0VfVVJMIiwiU0VBUkNIX1VSTCIsIkhFQURFUlMiLCJBY2NlcHQiLCJDb25uZWN0aW9uIiwic2NyYXBlUGlja25QYXkiLCJxdWVyeSIsInVybCIsImVuY29kZVVSSUNvbXBvbmVudCIsImNvbnNvbGUiLCJsb2ciLCJyZXNwb25zZSIsImdldCIsImhlYWRlcnMiLCJ0aW1lb3V0Iiwic3RhdHVzIiwiJCIsImxvYWQiLCJkYXRhIiwicHJvZHVjdHMiLCJlYWNoIiwiXyIsImVsIiwibmFtZSIsImZpbmQiLCJmaXJzdCIsInRleHQiLCJ0cmltIiwicHJpY2VUZXh0IiwicHJpY2UiLCJwYXJzZUZsb2F0IiwicmVwbGFjZSIsImhyZWYiLCJhdHRyIiwiaW1hZ2UiLCJpc05hTiIsIndlaWdodE1hdGNoIiwibWF0Y2giLCJ3ZWlnaHQiLCJwYXJzZVdlaWdodCIsInB1c2giLCJpZCIsImJyYW5kIiwiZXh0cmFjdEJyYW5kIiwidW5pdF9wcmljZSIsInN0b3JlIiwiY2F0ZWdvcnkiLCJpbmZlckNhdGVnb3J5Iiwic3RhcnRzV2l0aCIsImltYWdlX3VybCIsImluX3N0b2NrIiwic2NyYXBlZF9hdCIsIkRhdGUiLCJsZW5ndGgiLCJnZXRNb2NrUGlja25QYXlQcm9kdWN0cyIsImVyciIsInZhbHVlIiwidW5pdCIsInUiLCJ0b0xvd2VyQ2FzZSIsImJyYW5kcyIsImluY2x1ZGVzIiwic3BsaXQiLCJsb3dlciIsInRlc3QiLCJxIiwibm93IiwiY2F0YWxvZyIsImNoaWNrZW4iLCJtYWl6ZSIsInRvbWF0byIsIm9uaW9uIiwib2lsIiwicmljZSIsImJyZWFkIiwiZWdnIiwibWlsayIsInBhc3RhIiwicmVzdWx0cyIsImtleSIsIk9iamVjdCIsImVudHJpZXMiLCJ2YWx1ZXMiLCJmbGF0Iiwic2xpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/scrapers/picknpay.ts\n");

/***/ }),

/***/ "(rsc)/./lib/scrapers/shoprite.ts":
/*!**********************************!*\
  !*** ./lib/scrapers/shoprite.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   scrapeShoprite: () => (/* binding */ scrapeShoprite)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var _lib_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/utils */ \"(rsc)/./lib/utils.ts\");\n\n\nconst BASE_URL = \"https://www.shoprite.co.za\";\nconst HEADERS = {\n    \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\",\n    Accept: \"application/json, text/plain, */*\",\n    \"Accept-Language\": \"en-ZA,en;q=0.9\"\n};\n// Shoprite has a JSON API for product search\nconst SEARCH_API = `${BASE_URL}/c/za/all-products?q=`;\nasync function scrapeShoprite(query) {\n    try {\n        const url = `${SEARCH_API}${encodeURIComponent(query)}&pageSize=20&sort=price-asc`;\n        console.log(`     üåê Shoprite: Fetching \"${query}\"...`);\n        const response = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(url, {\n            headers: HEADERS,\n            timeout: 5000\n        });\n        console.log(`     üåê Shoprite: Response ${response.status} for \"${query}\"`);\n        const data = response.data;\n        const productList = data?.results || data?.products || [];\n        if (!productList.length) {\n            console.log(`     üì¶ Shoprite: No live results for \"${query}\", using mock data`);\n            return getMockShopriteProducts(query);\n        }\n        return productList.map((p)=>{\n            const price = p.price?.value || p.priceData?.price || 0;\n            const name = p.name || p.summary || \"\";\n            const weightMatch = name.match(/(\\d+(?:\\.\\d+)?)\\s*(kg|g|ml|l)/i);\n            const weight = weightMatch ? parseWeight(parseFloat(weightMatch[1]), weightMatch[2]) : 1000;\n            return {\n                id: (0,_lib_utils__WEBPACK_IMPORTED_MODULE_0__.generateId)(\"shoprite\", name),\n                name,\n                brand: p.brandData?.brandName || p.brand || name.split(\" \")[0],\n                price,\n                weight,\n                unit_price: price > 0 && weight > 0 ? price / weight * 100 : 0,\n                store: \"shoprite\",\n                category: inferCategory(name),\n                url: p.url ? `${BASE_URL}${p.url}` : BASE_URL,\n                image_url: p.images?.[0]?.url,\n                in_stock: p.stock?.stockLevelStatus !== \"outOfStock\",\n                scraped_at: new Date()\n            };\n        }).filter((p)=>p.price > 0);\n    } catch (err) {\n        console.log(`     ‚ö†Ô∏è  Shoprite: Scrape failed for \"${query}\" ‚Äî using mock data`);\n        return getMockShopriteProducts(query);\n    }\n}\nfunction parseWeight(value, unit) {\n    const u = unit.toLowerCase();\n    if (u === \"kg\" || u === \"l\") return value * 1000;\n    return value;\n}\nfunction inferCategory(name) {\n    const lower = name.toLowerCase();\n    if (/chicken|beef|lamb|pork|mince|fish|tuna/.test(lower)) return \"protein\";\n    if (/milk|cheese|yogurt|butter|cream|egg/.test(lower)) return \"dairy\";\n    if (/bread|flour|rice|pasta|pap|maize|oats/.test(lower)) return \"grain\";\n    if (/tomato|onion|potato|carrot|cabbage|spinach|pepper/.test(lower)) return \"vegetable\";\n    if (/oil|salt|pepper|spice|sauce/.test(lower)) return \"condiment\";\n    return \"other\";\n}\nfunction getMockShopriteProducts(query) {\n    const q = query.toLowerCase();\n    const now = new Date();\n    const catalog = {\n        chicken: [\n            {\n                id: \"shr-chicken-001\",\n                name: \"Shoprite Frozen Chicken Portions 1kg\",\n                brand: \"Shoprite\",\n                price: 49.99,\n                weight: 1000,\n                unit_price: 4.999,\n                store: \"shoprite\",\n                category: \"protein\",\n                url: \"https://www.shoprite.co.za/chicken\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"shr-chicken-002\",\n                name: \"Country Fair Chicken Thighs 800g\",\n                brand: \"Country Fair\",\n                price: 52.99,\n                weight: 800,\n                unit_price: 6.624,\n                store: \"shoprite\",\n                category: \"protein\",\n                url: \"https://www.shoprite.co.za/chicken-thighs\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        maize: [\n            {\n                id: \"shr-maize-001\",\n                name: \"Shoprite Super Maize Meal 5kg\",\n                brand: \"Shoprite\",\n                price: 59.99,\n                weight: 5000,\n                unit_price: 1.2,\n                store: \"shoprite\",\n                category: \"grain\",\n                url: \"https://www.shoprite.co.za/maize\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"shr-maize-002\",\n                name: \"White Star Maize Meal 5kg\",\n                brand: \"White Star\",\n                price: 67.99,\n                weight: 5000,\n                unit_price: 1.36,\n                store: \"shoprite\",\n                category: \"grain\",\n                url: \"https://www.shoprite.co.za/white-star\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        tomato: [\n            {\n                id: \"shr-tomato-001\",\n                name: \"Shoprite Tomato Paste 400g\",\n                brand: \"Shoprite\",\n                price: 12.99,\n                weight: 400,\n                unit_price: 3.248,\n                store: \"shoprite\",\n                category: \"vegetable\",\n                url: \"https://www.shoprite.co.za/tomato-paste\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"shr-tomato-002\",\n                name: \"All Gold Tomato Sauce 700g\",\n                brand: \"All Gold\",\n                price: 24.99,\n                weight: 700,\n                unit_price: 3.57,\n                store: \"shoprite\",\n                category: \"vegetable\",\n                url: \"https://www.shoprite.co.za/tomato-sauce\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"shr-tomato-003\",\n                name: \"Fresh Tomatoes 1kg\",\n                brand: \"Fresh Produce\",\n                price: 19.99,\n                weight: 1000,\n                unit_price: 1.999,\n                store: \"shoprite\",\n                category: \"vegetable\",\n                url: \"https://www.shoprite.co.za/fresh-tomatoes\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        onion: [\n            {\n                id: \"shr-onion-001\",\n                name: \"Brown Onions 2kg\",\n                brand: \"Fresh Produce\",\n                price: 22.99,\n                weight: 2000,\n                unit_price: 1.15,\n                store: \"shoprite\",\n                category: \"vegetable\",\n                url: \"https://www.shoprite.co.za/onions\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        oil: [\n            {\n                id: \"shr-oil-001\",\n                name: \"Shoprite Sunflower Oil 2L\",\n                brand: \"Shoprite\",\n                price: 44.99,\n                weight: 2000,\n                unit_price: 2.25,\n                store: \"shoprite\",\n                category: \"condiment\",\n                url: \"https://www.shoprite.co.za/cooking-oil\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        rice: [\n            {\n                id: \"shr-rice-001\",\n                name: \"Shoprite Long Grain Rice 5kg\",\n                brand: \"Shoprite\",\n                price: 69.99,\n                weight: 5000,\n                unit_price: 1.4,\n                store: \"shoprite\",\n                category: \"grain\",\n                url: \"https://www.shoprite.co.za/rice\",\n                in_stock: true,\n                scraped_at: now\n            },\n            {\n                id: \"shr-rice-002\",\n                name: \"Tastic Parboiled Rice 2kg\",\n                brand: \"Tastic\",\n                price: 37.99,\n                weight: 2000,\n                unit_price: 1.9,\n                store: \"shoprite\",\n                category: \"grain\",\n                url: \"https://www.shoprite.co.za/tastic\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        bread: [\n            {\n                id: \"shr-bread-001\",\n                name: \"Shoprite White Bread 700g\",\n                brand: \"Shoprite\",\n                price: 15.99,\n                weight: 700,\n                unit_price: 2.284,\n                store: \"shoprite\",\n                category: \"grain\",\n                url: \"https://www.shoprite.co.za/bread\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        egg: [\n            {\n                id: \"shr-eggs-001\",\n                name: \"Shoprite Medium Eggs 6 pack\",\n                brand: \"Shoprite\",\n                price: 22.99,\n                weight: 360,\n                unit_price: 6.386,\n                store: \"shoprite\",\n                category: \"dairy\",\n                url: \"https://www.shoprite.co.za/eggs\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        milk: [\n            {\n                id: \"shr-milk-001\",\n                name: \"Shoprite Full Cream Milk 1L\",\n                brand: \"Shoprite\",\n                price: 18.99,\n                weight: 1000,\n                unit_price: 1.899,\n                store: \"shoprite\",\n                category: \"dairy\",\n                url: \"https://www.shoprite.co.za/milk\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ],\n        pasta: [\n            {\n                id: \"shr-pasta-001\",\n                name: \"Shoprite Spaghetti 500g\",\n                brand: \"Shoprite\",\n                price: 14.99,\n                weight: 500,\n                unit_price: 2.998,\n                store: \"shoprite\",\n                category: \"grain\",\n                url: \"https://www.shoprite.co.za/pasta\",\n                in_stock: true,\n                scraped_at: now\n            }\n        ]\n    };\n    const results = [];\n    for (const [key, products] of Object.entries(catalog)){\n        if (q.includes(key) || key.includes(q)) {\n            results.push(...products);\n        }\n    }\n    return results.length > 0 ? results : Object.values(catalog).flat().slice(0, 5);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUN2RTtTQUNEO0lBQ0g7SUFFQSxNQUFNeEMsVUFBcUIsRUFBRTtJQUM3QixLQUFLLE1BQU0sQ0FBQ29ELEtBQUtuRCxTQUFTLElBQUlvRCxPQUFPQyxPQUFPLENBQUNiLFNBQVU7UUFDckQsSUFBSUYsRUFBRWdCLFFBQVEsQ0FBQ0gsUUFBUUEsSUFBSUcsUUFBUSxDQUFDaEIsSUFBSTtZQUN0Q3ZDLFFBQVF3RCxJQUFJLElBQUl2RDtRQUNsQjtJQUNGO0lBRUEsT0FBT0QsUUFBUUUsTUFBTSxHQUFHLElBQUlGLFVBQVVxRCxPQUFPSSxNQUFNLENBQUNoQixTQUFTaUIsSUFBSSxHQUFHQyxLQUFLLENBQUMsR0FBRztBQUMvRSIsInNvdXJjZXMiOlsid2VicGFjazovL3BhbnRyeWlxLy4vbGliL3NjcmFwZXJzL3Nob3ByaXRlLnRzP2VkODkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcbmltcG9ydCB7IFByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IGdlbmVyYXRlSWQgfSBmcm9tICdAL2xpYi91dGlscyc7XG5cbmNvbnN0IEJBU0VfVVJMID0gJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphJztcblxuY29uc3QgSEVBREVSUyA9IHtcbiAgJ1VzZXItQWdlbnQnOlxuICAgICdNb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjQuMC4wLjAgU2FmYXJpLzUzNy4zNicsXG4gIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsXG4gICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tWkEsZW47cT0wLjknLFxufTtcblxuLy8gU2hvcHJpdGUgaGFzIGEgSlNPTiBBUEkgZm9yIHByb2R1Y3Qgc2VhcmNoXG5jb25zdCBTRUFSQ0hfQVBJID0gYCR7QkFTRV9VUkx9L2MvemEvYWxsLXByb2R1Y3RzP3E9YDtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNjcmFwZVNob3ByaXRlKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPFByb2R1Y3RbXT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVybCA9IGAke1NFQVJDSF9BUEl9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfSZwYWdlU2l6ZT0yMCZzb3J0PXByaWNlLWFzY2A7XG4gICAgY29uc29sZS5sb2coYCAgICAg8J+MkCBTaG9wcml0ZTogRmV0Y2hpbmcgXCIke3F1ZXJ5fVwiLi4uYCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQodXJsLCB7XG4gICAgICBoZWFkZXJzOiBIRUFERVJTLFxuICAgICAgdGltZW91dDogNTAwMCxcbiAgICB9KTtcbiAgICBjb25zb2xlLmxvZyhgICAgICDwn4yQIFNob3ByaXRlOiBSZXNwb25zZSAke3Jlc3BvbnNlLnN0YXR1c30gZm9yIFwiJHtxdWVyeX1cImApO1xuXG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgY29uc3QgcHJvZHVjdExpc3QgPSBkYXRhPy5yZXN1bHRzIHx8IGRhdGE/LnByb2R1Y3RzIHx8IFtdO1xuXG4gICAgaWYgKCFwcm9kdWN0TGlzdC5sZW5ndGgpIHtcbiAgICAgIGNvbnNvbGUubG9nKGAgICAgIPCfk6YgU2hvcHJpdGU6IE5vIGxpdmUgcmVzdWx0cyBmb3IgXCIke3F1ZXJ5fVwiLCB1c2luZyBtb2NrIGRhdGFgKTtcbiAgICAgIHJldHVybiBnZXRNb2NrU2hvcHJpdGVQcm9kdWN0cyhxdWVyeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb2R1Y3RMaXN0Lm1hcCgocDogYW55KSA9PiB7XG4gICAgICBjb25zdCBwcmljZSA9IHAucHJpY2U/LnZhbHVlIHx8IHAucHJpY2VEYXRhPy5wcmljZSB8fCAwO1xuICAgICAgY29uc3QgbmFtZSA9IHAubmFtZSB8fCBwLnN1bW1hcnkgfHwgJyc7XG4gICAgICBjb25zdCB3ZWlnaHRNYXRjaCA9IG5hbWUubWF0Y2goLyhcXGQrKD86XFwuXFxkKyk/KVxccyooa2d8Z3xtbHxsKS9pKTtcbiAgICAgIGNvbnN0IHdlaWdodCA9IHdlaWdodE1hdGNoXG4gICAgICAgID8gcGFyc2VXZWlnaHQocGFyc2VGbG9hdCh3ZWlnaHRNYXRjaFsxXSksIHdlaWdodE1hdGNoWzJdKVxuICAgICAgICA6IDEwMDA7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBnZW5lcmF0ZUlkKCdzaG9wcml0ZScsIG5hbWUpLFxuICAgICAgICBuYW1lLFxuICAgICAgICBicmFuZDogcC5icmFuZERhdGE/LmJyYW5kTmFtZSB8fCBwLmJyYW5kIHx8IG5hbWUuc3BsaXQoJyAnKVswXSxcbiAgICAgICAgcHJpY2UsXG4gICAgICAgIHdlaWdodCxcbiAgICAgICAgdW5pdF9wcmljZTogcHJpY2UgPiAwICYmIHdlaWdodCA+IDAgPyAocHJpY2UgLyB3ZWlnaHQpICogMTAwIDogMCxcbiAgICAgICAgc3RvcmU6ICdzaG9wcml0ZScgYXMgY29uc3QsXG4gICAgICAgIGNhdGVnb3J5OiBpbmZlckNhdGVnb3J5KG5hbWUpLFxuICAgICAgICB1cmw6IHAudXJsID8gYCR7QkFTRV9VUkx9JHtwLnVybH1gIDogQkFTRV9VUkwsXG4gICAgICAgIGltYWdlX3VybDogcC5pbWFnZXM/LlswXT8udXJsLFxuICAgICAgICBpbl9zdG9jazogcC5zdG9jaz8uc3RvY2tMZXZlbFN0YXR1cyAhPT0gJ291dE9mU3RvY2snLFxuICAgICAgICBzY3JhcGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcbiAgICB9KS5maWx0ZXIoKHA6IFByb2R1Y3QpID0+IHAucHJpY2UgPiAwKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5sb2coYCAgICAg4pqg77iPICBTaG9wcml0ZTogU2NyYXBlIGZhaWxlZCBmb3IgXCIke3F1ZXJ5fVwiIOKAlCB1c2luZyBtb2NrIGRhdGFgKTtcbiAgICByZXR1cm4gZ2V0TW9ja1Nob3ByaXRlUHJvZHVjdHMocXVlcnkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHBhcnNlV2VpZ2h0KHZhbHVlOiBudW1iZXIsIHVuaXQ6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IHUgPSB1bml0LnRvTG93ZXJDYXNlKCk7XG4gIGlmICh1ID09PSAna2cnIHx8IHUgPT09ICdsJykgcmV0dXJuIHZhbHVlICogMTAwMDtcbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5mdW5jdGlvbiBpbmZlckNhdGVnb3J5KG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGxvd2VyID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICBpZiAoL2NoaWNrZW58YmVlZnxsYW1ifHBvcmt8bWluY2V8ZmlzaHx0dW5hLy50ZXN0KGxvd2VyKSkgcmV0dXJuICdwcm90ZWluJztcbiAgaWYgKC9taWxrfGNoZWVzZXx5b2d1cnR8YnV0dGVyfGNyZWFtfGVnZy8udGVzdChsb3dlcikpIHJldHVybiAnZGFpcnknO1xuICBpZiAoL2JyZWFkfGZsb3VyfHJpY2V8cGFzdGF8cGFwfG1haXplfG9hdHMvLnRlc3QobG93ZXIpKSByZXR1cm4gJ2dyYWluJztcbiAgaWYgKC90b21hdG98b25pb258cG90YXRvfGNhcnJvdHxjYWJiYWdlfHNwaW5hY2h8cGVwcGVyLy50ZXN0KGxvd2VyKSkgcmV0dXJuICd2ZWdldGFibGUnO1xuICBpZiAoL29pbHxzYWx0fHBlcHBlcnxzcGljZXxzYXVjZS8udGVzdChsb3dlcikpIHJldHVybiAnY29uZGltZW50JztcbiAgcmV0dXJuICdvdGhlcic7XG59XG5cbmZ1bmN0aW9uIGdldE1vY2tTaG9wcml0ZVByb2R1Y3RzKHF1ZXJ5OiBzdHJpbmcpOiBQcm9kdWN0W10ge1xuICBjb25zdCBxID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblxuICBjb25zdCBjYXRhbG9nOiBSZWNvcmQ8c3RyaW5nLCBQcm9kdWN0W10+ID0ge1xuICAgIGNoaWNrZW46IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdzaHItY2hpY2tlbi0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgRnJvemVuIENoaWNrZW4gUG9ydGlvbnMgMWtnJywgYnJhbmQ6ICdTaG9wcml0ZScsXG4gICAgICAgIHByaWNlOiA0OS45OSwgd2VpZ2h0OiAxMDAwLCB1bml0X3ByaWNlOiA0Ljk5OSwgc3RvcmU6ICdzaG9wcml0ZScsIGNhdGVnb3J5OiAncHJvdGVpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL2NoaWNrZW4nLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdzaHItY2hpY2tlbi0wMDInLCBuYW1lOiAnQ291bnRyeSBGYWlyIENoaWNrZW4gVGhpZ2hzIDgwMGcnLCBicmFuZDogJ0NvdW50cnkgRmFpcicsXG4gICAgICAgIHByaWNlOiA1Mi45OSwgd2VpZ2h0OiA4MDAsIHVuaXRfcHJpY2U6IDYuNjI0LCBzdG9yZTogJ3Nob3ByaXRlJywgY2F0ZWdvcnk6ICdwcm90ZWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuc2hvcHJpdGUuY28uemEvY2hpY2tlbi10aGlnaHMnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIG1haXplOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2hyLW1haXplLTAwMScsIG5hbWU6ICdTaG9wcml0ZSBTdXBlciBNYWl6ZSBNZWFsIDVrZycsIGJyYW5kOiAnU2hvcHJpdGUnLFxuICAgICAgICBwcmljZTogNTkuOTksIHdlaWdodDogNTAwMCwgdW5pdF9wcmljZTogMS4yLCBzdG9yZTogJ3Nob3ByaXRlJywgY2F0ZWdvcnk6ICdncmFpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL21haXplJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2hyLW1haXplLTAwMicsIG5hbWU6ICdXaGl0ZSBTdGFyIE1haXplIE1lYWwgNWtnJywgYnJhbmQ6ICdXaGl0ZSBTdGFyJyxcbiAgICAgICAgcHJpY2U6IDY3Ljk5LCB3ZWlnaHQ6IDUwMDAsIHVuaXRfcHJpY2U6IDEuMzYsIHN0b3JlOiAnc2hvcHJpdGUnLCBjYXRlZ29yeTogJ2dyYWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuc2hvcHJpdGUuY28uemEvd2hpdGUtc3RhcicsIGluX3N0b2NrOiB0cnVlLCBzY3JhcGVkX2F0OiBub3csXG4gICAgICB9LFxuICAgIF0sXG4gICAgdG9tYXRvOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2hyLXRvbWF0by0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgVG9tYXRvIFBhc3RlIDQwMGcnLCBicmFuZDogJ1Nob3ByaXRlJyxcbiAgICAgICAgcHJpY2U6IDEyLjk5LCB3ZWlnaHQ6IDQwMCwgdW5pdF9wcmljZTogMy4yNDgsIHN0b3JlOiAnc2hvcHJpdGUnLCBjYXRlZ29yeTogJ3ZlZ2V0YWJsZScsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL3RvbWF0by1wYXN0ZScsIGluX3N0b2NrOiB0cnVlLCBzY3JhcGVkX2F0OiBub3csXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ3Noci10b21hdG8tMDAyJywgbmFtZTogJ0FsbCBHb2xkIFRvbWF0byBTYXVjZSA3MDBnJywgYnJhbmQ6ICdBbGwgR29sZCcsXG4gICAgICAgIHByaWNlOiAyNC45OSwgd2VpZ2h0OiA3MDAsIHVuaXRfcHJpY2U6IDMuNTcsIHN0b3JlOiAnc2hvcHJpdGUnLCBjYXRlZ29yeTogJ3ZlZ2V0YWJsZScsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL3RvbWF0by1zYXVjZScsIGluX3N0b2NrOiB0cnVlLCBzY3JhcGVkX2F0OiBub3csXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ3Noci10b21hdG8tMDAzJywgbmFtZTogJ0ZyZXNoIFRvbWF0b2VzIDFrZycsIGJyYW5kOiAnRnJlc2ggUHJvZHVjZScsXG4gICAgICAgIHByaWNlOiAxOS45OSwgd2VpZ2h0OiAxMDAwLCB1bml0X3ByaWNlOiAxLjk5OSwgc3RvcmU6ICdzaG9wcml0ZScsIGNhdGVnb3J5OiAndmVnZXRhYmxlJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuc2hvcHJpdGUuY28uemEvZnJlc2gtdG9tYXRvZXMnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIG9uaW9uOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2hyLW9uaW9uLTAwMScsIG5hbWU6ICdCcm93biBPbmlvbnMgMmtnJywgYnJhbmQ6ICdGcmVzaCBQcm9kdWNlJyxcbiAgICAgICAgcHJpY2U6IDIyLjk5LCB3ZWlnaHQ6IDIwMDAsIHVuaXRfcHJpY2U6IDEuMTUsIHN0b3JlOiAnc2hvcHJpdGUnLCBjYXRlZ29yeTogJ3ZlZ2V0YWJsZScsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL29uaW9ucycsIGluX3N0b2NrOiB0cnVlLCBzY3JhcGVkX2F0OiBub3csXG4gICAgICB9LFxuICAgIF0sXG4gICAgb2lsOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2hyLW9pbC0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgU3VuZmxvd2VyIE9pbCAyTCcsIGJyYW5kOiAnU2hvcHJpdGUnLFxuICAgICAgICBwcmljZTogNDQuOTksIHdlaWdodDogMjAwMCwgdW5pdF9wcmljZTogMi4yNSwgc3RvcmU6ICdzaG9wcml0ZScsIGNhdGVnb3J5OiAnY29uZGltZW50JyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuc2hvcHJpdGUuY28uemEvY29va2luZy1vaWwnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIHJpY2U6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdzaHItcmljZS0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgTG9uZyBHcmFpbiBSaWNlIDVrZycsIGJyYW5kOiAnU2hvcHJpdGUnLFxuICAgICAgICBwcmljZTogNjkuOTksIHdlaWdodDogNTAwMCwgdW5pdF9wcmljZTogMS40LCBzdG9yZTogJ3Nob3ByaXRlJywgY2F0ZWdvcnk6ICdncmFpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL3JpY2UnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdzaHItcmljZS0wMDInLCBuYW1lOiAnVGFzdGljIFBhcmJvaWxlZCBSaWNlIDJrZycsIGJyYW5kOiAnVGFzdGljJyxcbiAgICAgICAgcHJpY2U6IDM3Ljk5LCB3ZWlnaHQ6IDIwMDAsIHVuaXRfcHJpY2U6IDEuOSwgc3RvcmU6ICdzaG9wcml0ZScsIGNhdGVnb3J5OiAnZ3JhaW4nLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5zaG9wcml0ZS5jby56YS90YXN0aWMnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIGJyZWFkOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnc2hyLWJyZWFkLTAwMScsIG5hbWU6ICdTaG9wcml0ZSBXaGl0ZSBCcmVhZCA3MDBnJywgYnJhbmQ6ICdTaG9wcml0ZScsXG4gICAgICAgIHByaWNlOiAxNS45OSwgd2VpZ2h0OiA3MDAsIHVuaXRfcHJpY2U6IDIuMjg0LCBzdG9yZTogJ3Nob3ByaXRlJywgY2F0ZWdvcnk6ICdncmFpbicsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL2JyZWFkJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBlZ2c6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdzaHItZWdncy0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgTWVkaXVtIEVnZ3MgNiBwYWNrJywgYnJhbmQ6ICdTaG9wcml0ZScsXG4gICAgICAgIHByaWNlOiAyMi45OSwgd2VpZ2h0OiAzNjAsIHVuaXRfcHJpY2U6IDYuMzg2LCBzdG9yZTogJ3Nob3ByaXRlJywgY2F0ZWdvcnk6ICdkYWlyeScsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vd3d3LnNob3ByaXRlLmNvLnphL2VnZ3MnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICAgIG1pbGs6IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdzaHItbWlsay0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgRnVsbCBDcmVhbSBNaWxrIDFMJywgYnJhbmQ6ICdTaG9wcml0ZScsXG4gICAgICAgIHByaWNlOiAxOC45OSwgd2VpZ2h0OiAxMDAwLCB1bml0X3ByaWNlOiAxLjg5OSwgc3RvcmU6ICdzaG9wcml0ZScsIGNhdGVnb3J5OiAnZGFpcnknLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5zaG9wcml0ZS5jby56YS9taWxrJywgaW5fc3RvY2s6IHRydWUsIHNjcmFwZWRfYXQ6IG5vdyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBwYXN0YTogW1xuICAgICAge1xuICAgICAgICBpZDogJ3Noci1wYXN0YS0wMDEnLCBuYW1lOiAnU2hvcHJpdGUgU3BhZ2hldHRpIDUwMGcnLCBicmFuZDogJ1Nob3ByaXRlJyxcbiAgICAgICAgcHJpY2U6IDE0Ljk5LCB3ZWlnaHQ6IDUwMCwgdW5pdF9wcmljZTogMi45OTgsIHN0b3JlOiAnc2hvcHJpdGUnLCBjYXRlZ29yeTogJ2dyYWluJyxcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuc2hvcHJpdGUuY28uemEvcGFzdGEnLCBpbl9zdG9jazogdHJ1ZSwgc2NyYXBlZF9hdDogbm93LFxuICAgICAgfSxcbiAgICBdLFxuICB9O1xuXG4gIGNvbnN0IHJlc3VsdHM6IFByb2R1Y3RbXSA9IFtdO1xuICBmb3IgKGNvbnN0IFtrZXksIHByb2R1Y3RzXSBvZiBPYmplY3QuZW50cmllcyhjYXRhbG9nKSkge1xuICAgIGlmIChxLmluY2x1ZGVzKGtleSkgfHwga2V5LmluY2x1ZGVzKHEpKSB7XG4gICAgICByZXN1bHRzLnB1c2goLi4ucHJvZHVjdHMpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHRzLmxlbmd0aCA+IDAgPyByZXN1bHRzIDogT2JqZWN0LnZhbHVlcyhjYXRhbG9nKS5mbGF0KCkuc2xpY2UoMCwgNSk7XG59XG4iXSwibmFtZXMiOlsiYXhpb3MiLCJnZW5lcmF0ZUlkIiwiQkFTRV9VUkwiLCJIRUFERVJTIiwiQWNjZXB0IiwiU0VBUkNIX0FQSSIsInNjcmFwZVNob3ByaXRlIiwicXVlcnkiLCJ1cmwiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJnZXQiLCJoZWFkZXJzIiwidGltZW91dCIsInN0YXR1cyIsImRhdGEiLCJwcm9kdWN0TGlzdCIsInJlc3VsdHMiLCJwcm9kdWN0cyIsImxlbmd0aCIsImdldE1vY2tTaG9wcml0ZVByb2R1Y3RzIiwibWFwIiwicCIsInByaWNlIiwidmFsdWUiLCJwcmljZURhdGEiLCJuYW1lIiwic3VtbWFyeSIsIndlaWdodE1hdGNoIiwibWF0Y2giLCJ3ZWlnaHQiLCJwYXJzZVdlaWdodCIsInBhcnNlRmxvYXQiLCJpZCIsImJyYW5kIiwiYnJhbmREYXRhIiwiYnJhbmROYW1lIiwic3BsaXQiLCJ1bml0X3ByaWNlIiwic3RvcmUiLCJjYXRlZ29yeSIsImluZmVyQ2F0ZWdvcnkiLCJpbWFnZV91cmwiLCJpbWFnZXMiLCJpbl9zdG9jayIsInN0b2NrIiwic3RvY2tMZXZlbFN0YXR1cyIsInNjcmFwZWRfYXQiLCJEYXRlIiwiZmlsdGVyIiwiZXJyIiwidW5pdCIsInUiLCJ0b0xvd2VyQ2FzZSIsImxvd2VyIiwidGVzdCIsInEiLCJub3ciLCJjYXRhbG9nIiwiY2hpY2tlbiIsIm1haXplIiwidG9tYXRvIiwib25pb24iLCJvaWwiLCJyaWNlIiwiYnJlYWQiLCJlZ2ciLCJtaWxrIiwicGFzdGEiLCJrZXkiLCJPYmplY3QiLCJlbnRyaWVzIiwiaW5jbHVkZXMiLCJwdXNoIiwidmFsdWVzIiwiZmxhdCIsInNsaWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/scrapers/shoprite.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils.ts":
/*!**********************!*\
  !*** ./lib/utils.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clamp: () => (/* binding */ clamp),\n/* harmony export */   formatZAR: () => (/* binding */ formatZAR),\n/* harmony export */   generateId: () => (/* binding */ generateId)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction generateId(store, name) {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"md5\").update(`${store}:${name.toLowerCase()}`).digest(\"hex\").slice(0, 16);\n}\nfunction formatZAR(amount) {\n    return new Intl.NumberFormat(\"en-ZA\", {\n        style: \"currency\",\n        currency: \"ZAR\",\n        minimumFractionDigits: 2\n    }).format(amount);\n}\nfunction clamp(value, min, max) {\n    return Math.min(Math.max(value, min), max);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBNEI7QUFFckIsU0FBU0MsV0FBV0MsS0FBYSxFQUFFQyxJQUFZO0lBQ3BELE9BQU9ILHdEQUNNLENBQUMsT0FDWEssTUFBTSxDQUFDLENBQUMsRUFBRUgsTUFBTSxDQUFDLEVBQUVDLEtBQUtHLFdBQVcsR0FBRyxDQUFDLEVBQ3ZDQyxNQUFNLENBQUMsT0FDUEMsS0FBSyxDQUFDLEdBQUc7QUFDZDtBQUVPLFNBQVNDLFVBQVVDLE1BQWM7SUFDdEMsT0FBTyxJQUFJQyxLQUFLQyxZQUFZLENBQUMsU0FBUztRQUNwQ0MsT0FBTztRQUNQQyxVQUFVO1FBQ1ZDLHVCQUF1QjtJQUN6QixHQUFHQyxNQUFNLENBQUNOO0FBQ1o7QUFFTyxTQUFTTyxNQUFNQyxLQUFhLEVBQUVDLEdBQVcsRUFBRUMsR0FBVztJQUMzRCxPQUFPQyxLQUFLRixHQUFHLENBQUNFLEtBQUtELEdBQUcsQ0FBQ0YsT0FBT0MsTUFBTUM7QUFDeEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYW50cnlpcS8uL2xpYi91dGlscy50cz9mNzQ1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlSWQoc3RvcmU6IHN0cmluZywgbmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGNyeXB0b1xuICAgIC5jcmVhdGVIYXNoKCdtZDUnKVxuICAgIC51cGRhdGUoYCR7c3RvcmV9OiR7bmFtZS50b0xvd2VyQ2FzZSgpfWApXG4gICAgLmRpZ2VzdCgnaGV4JylcbiAgICAuc2xpY2UoMCwgMTYpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0WkFSKGFtb3VudDogbnVtYmVyKTogc3RyaW5nIHtcbiAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZW4tWkEnLCB7XG4gICAgc3R5bGU6ICdjdXJyZW5jeScsXG4gICAgY3VycmVuY3k6ICdaQVInLFxuICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMixcbiAgfSkuZm9ybWF0KGFtb3VudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCh2YWx1ZTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xuICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIG1pbiksIG1heCk7XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiZ2VuZXJhdGVJZCIsInN0b3JlIiwibmFtZSIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJ0b0xvd2VyQ2FzZSIsImRpZ2VzdCIsInNsaWNlIiwiZm9ybWF0WkFSIiwiYW1vdW50IiwiSW50bCIsIk51bWJlckZvcm1hdCIsInN0eWxlIiwiY3VycmVuY3kiLCJtaW5pbXVtRnJhY3Rpb25EaWdpdHMiLCJmb3JtYXQiLCJjbGFtcCIsInZhbHVlIiwibWluIiwibWF4IiwiTWF0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod","vendor-chunks/@redis","vendor-chunks/axios","vendor-chunks/generic-pool","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/yallist","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/supports-color","vendor-chunks/redis","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream","vendor-chunks/cluster-key-slot"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-basket%2Froute&page=%2Fapi%2Fgenerate-basket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-basket%2Froute.ts&appDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fchosen333%2FMusic%2Fpantryip&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();